

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Projections: adding/selecting columns &mdash; Ibis 0.3.0 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Ibis 0.3.0 documentation" href="../index.html"/>
        <link rel="up" title="Tutorial" href="../tutorial.html"/>
        <link rel="next" title="Type casting" href="3.html"/>
        <link rel="prev" title="Basics: Aggregation, filtering, limits" href="1.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="../index.html" class="fa fa-home"> Ibis</a>
        
        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting-started.html">Installation and Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../getting-started.html#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started.html#creating-a-client">Creating a client</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started.html#learning-resources">Learning resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started.html#using-ibis-with-the-cloudera-quickstart-vm">Using Ibis with the Cloudera Quickstart VM</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../configuration.html">Configuring Ibis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../configuration.html#ibis-global-configuration">Ibis global configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration.html#working-with-secure-clusters-kerberos">Working with secure clusters (Kerberos)</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../tutorial.html">Tutorial</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="0.html">Intro and Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="0.html#getting-started">Getting started</a></li>
<li class="toctree-l2"><a class="reference internal" href="1.html">Basics: Aggregation, filtering, limits</a></li>
<li class="toctree-l2"><a class="reference internal" href="1.html#accessing-an-impala-table">Accessing an Impala table</a></li>
<li class="toctree-l2"><a class="reference internal" href="1.html#column-selection-and-basic-expressions">Column selection and basic expressions</a></li>
<li class="toctree-l2"><a class="reference internal" href="1.html#interactive-mode">Interactive mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="1.html#verbose-mode-and-logging">Verbose mode and logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="1.html#aggregation-basics">Aggregation basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="1.html#filtering">Filtering</a></li>
<li class="toctree-l2"><a class="reference internal" href="1.html#limits">Limits</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">Projections: adding/selecting columns</a></li>
<li class="toctree-l2"><a class="reference internal" href="#joins">Joins</a></li>
<li class="toctree-l2"><a class="reference internal" href="#joins-are-declarations-of-intent">Joins are declarations of intent</a></li>
<li class="toctree-l2"><a class="reference internal" href="#explicit-join-materialization">Explicit join materialization</a></li>
<li class="toctree-l2"><a class="reference internal" href="#writing-down-join-keys">Writing down join keys</a></li>
<li class="toctree-l2"><a class="reference internal" href="#join-referential-nuances">Join referential nuances</a></li>
<li class="toctree-l2"><a class="reference internal" href="#aggregating-joined-table-with-metrics-involving-more-than-one-base-reference">Aggregating joined table with metrics involving more than one base reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sorting">Sorting</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.html">Type casting</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.html#case-if-then-else-expressions">Case / if-then-else expressions</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.html#set-membership">Set membership</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.html#null-ness">Null-ness</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.html#distinct-based-operations">Distinct-based operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.html#string-operations">String operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.html#timestamp-operations">Timestamp operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="4.html">Creating new Impala tables from Ibis expressions</a></li>
<li class="toctree-l2"><a class="reference internal" href="4.html#inserting-data-into-existing-impala-tables">Inserting data into existing Impala tables</a></li>
<li class="toctree-l2"><a class="reference internal" href="4.html#uploading-downloading-data-from-hdfs">Uploading / downloading data from HDFS</a></li>
<li class="toctree-l2"><a class="reference internal" href="4.html#queries-on-parquet-avro-and-delimited-files-in-hdfs">Queries on Parquet, Avro, and Delimited files in HDFS</a></li>
<li class="toctree-l2"><a class="reference internal" href="4.html#other-helper-functions-for-interacting-with-the-database">Other helper functions for interacting with the database</a></li>
<li class="toctree-l2"><a class="reference internal" href="4.html#dealing-with-partitioned-tables-in-impala">Dealing with Partitioned tables in Impala</a></li>
<li class="toctree-l2"><a class="reference internal" href="4.html#faster-queries-on-small-data-in-impala">Faster queries on small data in Impala</a></li>
<li class="toctree-l2"><a class="reference internal" href="5.html">&#8220;Top-K&#8221; Filtering</a></li>
<li class="toctree-l2"><a class="reference internal" href="5.html#self-joins">Self joins</a></li>
<li class="toctree-l2"><a class="reference internal" href="6.html">More filtering mojo for your analytics</a></li>
<li class="toctree-l2"><a class="reference internal" href="6.html#using-scalar-aggregates-in-filters">Using scalar aggregates in filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="6.html#conditional-aggregates">Conditional aggregates</a></li>
<li class="toctree-l2"><a class="reference internal" href="6.html#existence-filters">&#8220;Existence&#8221; filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="7.html">Frequency tables</a></li>
<li class="toctree-l2"><a class="reference internal" href="7.html#binning-and-histograms">Binning and histograms</a></li>
<li class="toctree-l2"><a class="reference internal" href="7.html#filtering-in-aggregations">Filtering in aggregations</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../api.html#creating-connections">Creating connections</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#impala-client">Impala client</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#hdfs">HDFS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#top-level-expression-apis">Top-level expression APIs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#api-table">Table methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#generic-value-methods">Generic value methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#general-numeric-methods">General numeric methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#integer-methods">Integer methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#string-methods">String methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#timestamp-methods">Timestamp methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#boolean-methods">Boolean methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#category-methods">Category methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#decimal-methods">Decimal methods</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../sql.html">Ibis for SQL Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../impala.html">Ibis for Impala users</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../impala.html#table-metadata">Table metadata</a></li>
<li class="toctree-l2"><a class="reference internal" href="../impala.html#table-partition-management">Table partition management</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../release.html">Release Notes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../release.html#july-20-2015">0.3.0 (July 20, 2015)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#june-16-2015">0.2.0 (June 16, 2015)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#march-26-2015">0.1.0 (March 26, 2015)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../developer.html">Developing and Contributing to Ibis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../developer.html#test-environment-setup">Test environment setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developer.html#contribution-ideas">Contribution Ideas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developer.html#contributor-license-agreements">Contributor License Agreements</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../type-system.html">Ibis design internals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../legal.html">Legal</a></li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">Ibis</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../tutorial.html">Tutorial</a> &raquo;</li>
      
    <li>Projections: adding/selecting columns</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="../_sources/generated-notebooks/2.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="code python highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">ibis</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">hdfs_port</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;IBIS_WEBHDFS_PORT&#39;</span><span class="p">,</span> <span class="mi">50070</span><span class="p">)</span>

<span class="n">ic</span> <span class="o">=</span> <span class="n">ibis</span><span class="o">.</span><span class="n">impala_connect</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s">&#39;quickstart.cloudera&#39;</span><span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="s">&#39;ibis_testing&#39;</span><span class="p">)</span>
<span class="n">hdfs</span> <span class="o">=</span> <span class="n">ibis</span><span class="o">.</span><span class="n">hdfs_connect</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s">&#39;quickstart.cloudera&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="n">hdfs_port</span><span class="p">)</span>
<span class="n">con</span> <span class="o">=</span> <span class="n">ibis</span><span class="o">.</span><span class="n">make_client</span><span class="p">(</span><span class="n">ic</span><span class="p">,</span> <span class="n">hdfs_client</span><span class="o">=</span><span class="n">hdfs</span><span class="p">)</span>

<span class="n">ibis</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">interactive</span> <span class="o">=</span> <span class="bp">True</span>
</pre></div>
</div>
<div class="section" id="projections-adding-selecting-columns">
<h1>Projections: adding/selecting columns<a class="headerlink" href="#projections-adding-selecting-columns" title="Permalink to this headline">¶</a></h1>
<p>Projections are the general way for adding new columns to tables, or
selecting or removing existing ones.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">table</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="s">&#39;functional_alltypes&#39;</span><span class="p">)</span>
<span class="n">table</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<pre class="literal-block">
        id bool_col  tinyint_col  smallint_col  int_col  bigint_col  0     4550     True            0             0        0           0
1     4551    False            1             1        1          10
2     4552     True            2             2        2          20
3     4553    False            3             3        3          30
4     4554     True            4             4        4          40
5     4555    False            5             5        5          50
6     4556     True            6             6        6          60
7     4557    False            7             7        7          70
8     4558     True            8             8        8          80
9     4559    False            9             9        9          90
10    4560     True            0             0        0           0
11    4561    False            1             1        1          10
12    4562     True            2             2        2          20
13    4563    False            3             3        3          30
14    4564     True            4             4        4          40
15    4565    False            5             5        5          50
16    4566     True            6             6        6          60
17    4567    False            7             7        7          70
18    4568     True            8             8        8          80
19    4569    False            9             9        9          90
20    4570     True            0             0        0           0
21    4571    False            1             1        1          10
22    4572     True            2             2        2          20
23    4573    False            3             3        3          30
24    4574     True            4             4        4          40
25    4575    False            5             5        5          50
26    4576     True            6             6        6          60
27    4577    False            7             7        7          70
28    4578     True            8             8        8          80
29    4579    False            9             9        9          90
...    ...      ...          ...           ...      ...         ...
7270  3930     True            0             0        0           0
7271  3931    False            1             1        1          10
7272  3932     True            2             2        2          20
7273  3933    False            3             3        3          30
7274  3934     True            4             4        4          40
7275  3935    False            5             5        5          50
7276  3936     True            6             6        6          60
7277  3937    False            7             7        7          70
7278  3938     True            8             8        8          80
7279  3939    False            9             9        9          90
7280  3940     True            0             0        0           0
7281  3941    False            1             1        1          10
7282  3942     True            2             2        2          20
7283  3943    False            3             3        3          30
7284  3944     True            4             4        4          40
7285  3945    False            5             5        5          50
7286  3946     True            6             6        6          60
7287  3947    False            7             7        7          70
7288  3948     True            8             8        8          80
7289  3949    False            9             9        9          90
7290  3950     True            0             0        0           0
7291  3951    False            1             1        1          10
7292  3952     True            2             2        2          20
7293  3953    False            3             3        3          30
7294  3954     True            4             4        4          40
7295  3955    False            5             5        5          50
7296  3956     True            6             6        6          60
7297  3957    False            7             7        7          70
7298  3958     True            8             8        8          80
7299  3959    False            9             9        9          90

      float_col  double_col date_string_col string_col  0           0.0         0.0        04/01/10          0
1           1.1        10.1        04/01/10          1
2           2.2        20.2        04/01/10          2
3           3.3        30.3        04/01/10          3
4           4.4        40.4        04/01/10          4
5           5.5        50.5        04/01/10          5
6           6.6        60.6        04/01/10          6
7           7.7        70.7        04/01/10          7
8           8.8        80.8        04/01/10          8
9           9.9        90.9        04/01/10          9
10          0.0         0.0        04/02/10          0
11          1.1        10.1        04/02/10          1
12          2.2        20.2        04/02/10          2
13          3.3        30.3        04/02/10          3
14          4.4        40.4        04/02/10          4
15          5.5        50.5        04/02/10          5
16          6.6        60.6        04/02/10          6
17          7.7        70.7        04/02/10          7
18          8.8        80.8        04/02/10          8
19          9.9        90.9        04/02/10          9
20          0.0         0.0        04/03/10          0
21          1.1        10.1        04/03/10          1
22          2.2        20.2        04/03/10          2
23          3.3        30.3        04/03/10          3
24          4.4        40.4        04/03/10          4
25          5.5        50.5        04/03/10          5
26          6.6        60.6        04/03/10          6
27          7.7        70.7        04/03/10          7
28          8.8        80.8        04/03/10          8
29          9.9        90.9        04/03/10          9
...         ...         ...             ...        ...
7270        0.0         0.0        01/29/10          0
7271        1.1        10.1        01/29/10          1
7272        2.2        20.2        01/29/10          2
7273        3.3        30.3        01/29/10          3
7274        4.4        40.4        01/29/10          4
7275        5.5        50.5        01/29/10          5
7276        6.6        60.6        01/29/10          6
7277        7.7        70.7        01/29/10          7
7278        8.8        80.8        01/29/10          8
7279        9.9        90.9        01/29/10          9
7280        0.0         0.0        01/30/10          0
7281        1.1        10.1        01/30/10          1
7282        2.2        20.2        01/30/10          2
7283        3.3        30.3        01/30/10          3
7284        4.4        40.4        01/30/10          4
7285        5.5        50.5        01/30/10          5
7286        6.6        60.6        01/30/10          6
7287        7.7        70.7        01/30/10          7
7288        8.8        80.8        01/30/10          8
7289        9.9        90.9        01/30/10          9
7290        0.0         0.0        01/31/10          0
7291        1.1        10.1        01/31/10          1
7292        2.2        20.2        01/31/10          2
7293        3.3        30.3        01/31/10          3
7294        4.4        40.4        01/31/10          4
7295        5.5        50.5        01/31/10          5
7296        6.6        60.6        01/31/10          6
7297        7.7        70.7        01/31/10          7
7298        8.8        80.8        01/31/10          8
7299        9.9        90.9        01/31/10          9

               timestamp_col  year  month
0    2010-04-01 00:00:00.000  2010      4
1    2010-04-01 00:01:00.000  2010      4
2    2010-04-01 00:02:00.100  2010      4
3    2010-04-01 00:03:00.300  2010      4
4    2010-04-01 00:04:00.600  2010      4
5    2010-04-01 00:05:00.100  2010      4
6    2010-04-01 00:06:00.150  2010      4
7    2010-04-01 00:07:00.210  2010      4
8    2010-04-01 00:08:00.280  2010      4
9    2010-04-01 00:09:00.360  2010      4
10   2010-04-02 00:10:00.450  2010      4
11   2010-04-02 00:11:00.450  2010      4
12   2010-04-02 00:12:00.460  2010      4
13   2010-04-02 00:13:00.480  2010      4
14   2010-04-02 00:14:00.510  2010      4
15   2010-04-02 00:15:00.550  2010      4
16   2010-04-02 00:16:00.600  2010      4
17   2010-04-02 00:17:00.660  2010      4
18   2010-04-02 00:18:00.730  2010      4
19   2010-04-02 00:19:00.810  2010      4
20   2010-04-03 00:20:00.900  2010      4
21   2010-04-03 00:21:00.900  2010      4
22   2010-04-03 00:22:00.910  2010      4
23   2010-04-03 00:23:00.930  2010      4
24   2010-04-03 00:24:00.960  2010      4
25   2010-04-03 00:25:01.000  2010      4
26   2010-04-03 00:26:01.500  2010      4
27   2010-04-03 00:27:01.110  2010      4
28   2010-04-03 00:28:01.180  2010      4
29   2010-04-03 00:29:01.260  2010      4
...                      ...   ...    ...
7270 2010-01-29 04:40:12.600  2010      1
7271 2010-01-29 04:41:12.600  2010      1
7272 2010-01-29 04:42:12.610  2010      1
7273 2010-01-29 04:43:12.630  2010      1
7274 2010-01-29 04:44:12.660  2010      1
7275 2010-01-29 04:45:12.700  2010      1
7276 2010-01-29 04:46:12.750  2010      1
7277 2010-01-29 04:47:12.810  2010      1
7278 2010-01-29 04:48:12.880  2010      1
7279 2010-01-29 04:49:12.960  2010      1
7280 2010-01-30 04:50:13.500  2010      1
7281 2010-01-30 04:51:13.500  2010      1
7282 2010-01-30 04:52:13.600  2010      1
7283 2010-01-30 04:53:13.800  2010      1
7284 2010-01-30 04:54:13.110  2010      1
7285 2010-01-30 04:55:13.150  2010      1
7286 2010-01-30 04:56:13.200  2010      1
7287 2010-01-30 04:57:13.260  2010      1
7288 2010-01-30 04:58:13.330  2010      1
7289 2010-01-30 04:59:13.410  2010      1
7290 2010-01-31 05:00:13.500  2010      1
7291 2010-01-31 05:01:13.500  2010      1
7292 2010-01-31 05:02:13.510  2010      1
7293 2010-01-31 05:03:13.530  2010      1
7294 2010-01-31 05:04:13.560  2010      1
7295 2010-01-31 05:05:13.600  2010      1
7296 2010-01-31 05:06:13.650  2010      1
7297 2010-01-31 05:07:13.710  2010      1
7298 2010-01-31 05:08:13.780  2010      1
7299 2010-01-31 05:09:13.860  2010      1

[7300 rows x 13 columns]
</pre>
<p>First, the basics: selecting columns:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">proj</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="s">&#39;bool_col&#39;</span><span class="p">,</span> <span class="s">&#39;int_col&#39;</span><span class="p">,</span> <span class="s">&#39;double_col&#39;</span><span class="p">]</span>

<span class="n">proj</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>     bool_col  int_col  double_col
0        True        0         0.0
1       False        1        10.1
2        True        2        20.2
3       False        3        30.3
4        True        4        40.4
5       False        5        50.5
6        True        6        60.6
7       False        7        70.7
8        True        8        80.8
9       False        9        90.9
10       True        0         0.0
11      False        1        10.1
12       True        2        20.2
13      False        3        30.3
14       True        4        40.4
15      False        5        50.5
16       True        6        60.6
17      False        7        70.7
18       True        8        80.8
19      False        9        90.9
20       True        0         0.0
21      False        1        10.1
22       True        2        20.2
23      False        3        30.3
24       True        4        40.4
25      False        5        50.5
26       True        6        60.6
27      False        7        70.7
28       True        8        80.8
29      False        9        90.9
...       ...      ...         ...
7270     True        0         0.0
7271    False        1        10.1
7272     True        2        20.2
7273    False        3        30.3
7274     True        4        40.4
7275    False        5        50.5
7276     True        6        60.6
7277    False        7        70.7
7278     True        8        80.8
7279    False        9        90.9
7280     True        0         0.0
7281    False        1        10.1
7282     True        2        20.2
7283    False        3        30.3
7284     True        4        40.4
7285    False        5        50.5
7286     True        6        60.6
7287    False        7        70.7
7288     True        8        80.8
7289    False        9        90.9
7290     True        0         0.0
7291    False        1        10.1
7292     True        2        20.2
7293    False        3        30.3
7294     True        4        40.4
7295    False        5        50.5
7296     True        6        60.6
7297    False        7        70.7
7298     True        8        80.8
7299    False        9        90.9

[7300 rows x 3 columns]
</pre></div>
</div>
<p>You can make a list of columns you want, too, and pass that:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">to_select</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;bool_col&#39;</span><span class="p">,</span> <span class="s">&#39;int_col&#39;</span><span class="p">]</span>
<span class="n">table</span><span class="p">[</span><span class="n">to_select</span><span class="p">]</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>     bool_col  int_col
0        True        0
1       False        1
2        True        2
3       False        3
4        True        4
5       False        5
6        True        6
7       False        7
8        True        8
9       False        9
10       True        0
11      False        1
12       True        2
13      False        3
14       True        4
15      False        5
16       True        6
17      False        7
18       True        8
19      False        9
20       True        0
21      False        1
22       True        2
23      False        3
24       True        4
25      False        5
26       True        6
27      False        7
28       True        8
29      False        9
...       ...      ...
7270     True        0
7271    False        1
7272     True        2
7273    False        3
7274     True        4
7275    False        5
7276     True        6
7277    False        7
7278     True        8
7279    False        9
7280     True        0
7281    False        1
7282     True        2
7283    False        3
7284     True        4
7285    False        5
7286     True        6
7287    False        7
7288     True        8
7289    False        9
7290     True        0
7291    False        1
7292     True        2
7293    False        3
7294     True        4
7295    False        5
7296     True        6
7297    False        7
7298     True        8
7299    False        9

[7300 rows x 2 columns]
</pre></div>
</div>
<p>You can also use the explicit <code class="docutils literal"><span class="pre">projection</span></code> or <code class="docutils literal"><span class="pre">select</span></code> functions</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">table</span><span class="o">.</span><span class="n">select</span><span class="p">([</span><span class="s">&#39;int_col&#39;</span><span class="p">,</span> <span class="s">&#39;double_col&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>      int_col  double_col
0           0         0.0
1           1        10.1
2           2        20.2
3           3        30.3
4           4        40.4
5           5        50.5
6           6        60.6
7           7        70.7
8           8        80.8
9           9        90.9
10          0         0.0
11          1        10.1
12          2        20.2
13          3        30.3
14          4        40.4
15          5        50.5
16          6        60.6
17          7        70.7
18          8        80.8
19          9        90.9
20          0         0.0
21          1        10.1
22          2        20.2
23          3        30.3
24          4        40.4
25          5        50.5
26          6        60.6
27          7        70.7
28          8        80.8
29          9        90.9
...       ...         ...
7270        0         0.0
7271        1        10.1
7272        2        20.2
7273        3        30.3
7274        4        40.4
7275        5        50.5
7276        6        60.6
7277        7        70.7
7278        8        80.8
7279        9        90.9
7280        0         0.0
7281        1        10.1
7282        2        20.2
7283        3        30.3
7284        4        40.4
7285        5        50.5
7286        6        60.6
7287        7        70.7
7288        8        80.8
7289        9        90.9
7290        0         0.0
7291        1        10.1
7292        2        20.2
7293        3        30.3
7294        4        40.4
7295        5        50.5
7296        6        60.6
7297        7        70.7
7298        8        80.8
7299        9        90.9

[7300 rows x 2 columns]
</pre></div>
</div>
<p>We can add new columns by using named column expressions</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">bigger_expr</span> <span class="o">=</span> <span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">int_col</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="s">&#39;bigger_ints&#39;</span><span class="p">)</span>
<span class="n">proj2</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="s">&#39;int_col&#39;</span><span class="p">,</span> <span class="n">bigger_expr</span><span class="p">]</span>
<span class="n">proj2</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>      int_col  bigger_ints
0           0            0
1           1            2
2           2            4
3           3            6
4           4            8
5           5           10
6           6           12
7           7           14
8           8           16
9           9           18
10          0            0
11          1            2
12          2            4
13          3            6
14          4            8
15          5           10
16          6           12
17          7           14
18          8           16
19          9           18
20          0            0
21          1            2
22          2            4
23          3            6
24          4            8
25          5           10
26          6           12
27          7           14
28          8           16
29          9           18
...       ...          ...
7270        0            0
7271        1            2
7272        2            4
7273        3            6
7274        4            8
7275        5           10
7276        6           12
7277        7           14
7278        8           16
7279        9           18
7280        0            0
7281        1            2
7282        2            4
7283        3            6
7284        4            8
7285        5           10
7286        6           12
7287        7           14
7288        8           16
7289        9           18
7290        0            0
7291        1            2
7292        2            4
7293        3            6
7294        4            8
7295        5           10
7296        6           12
7297        7           14
7298        8           16
7299        9           18

[7300 rows x 2 columns]
</pre></div>
</div>
<p>Adding columns is a shortcut for projection. In Ibis, adding columns
always produces a new table reference</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">table2</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="n">bigger_expr</span><span class="p">)</span>
<span class="n">table2</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<pre class="literal-block">
        id bool_col  tinyint_col  smallint_col  int_col  bigint_col  0     5460     True            0             0        0           0
1     5461    False            1             1        1          10
2     5462     True            2             2        2          20
3     5463    False            3             3        3          30
4     5464     True            4             4        4          40
5     5465    False            5             5        5          50
6     5466     True            6             6        6          60
7     5467    False            7             7        7          70
8     5468     True            8             8        8          80
9     5469    False            9             9        9          90
10    5470     True            0             0        0           0
11    5471    False            1             1        1          10
12    5472     True            2             2        2          20
13    5473    False            3             3        3          30
14    5474     True            4             4        4          40
15    5475    False            5             5        5          50
16    5476     True            6             6        6          60
17    5477    False            7             7        7          70
18    5478     True            8             8        8          80
19    5479    False            9             9        9          90
20    5480     True            0             0        0           0
21    5481    False            1             1        1          10
22    5482     True            2             2        2          20
23    5483    False            3             3        3          30
24    5484     True            4             4        4          40
25    5485    False            5             5        5          50
26    5486     True            6             6        6          60
27    5487    False            7             7        7          70
28    5488     True            8             8        8          80
29    5489    False            9             9        9          90
...    ...      ...          ...           ...      ...         ...
7270  3620     True            0             0        0           0
7271  3621    False            1             1        1          10
7272  3622     True            2             2        2          20
7273  3623    False            3             3        3          30
7274  3624     True            4             4        4          40
7275  3625    False            5             5        5          50
7276  3626     True            6             6        6          60
7277  3627    False            7             7        7          70
7278  3628     True            8             8        8          80
7279  3629    False            9             9        9          90
7280  3630     True            0             0        0           0
7281  3631    False            1             1        1          10
7282  3632     True            2             2        2          20
7283  3633    False            3             3        3          30
7284  3634     True            4             4        4          40
7285  3635    False            5             5        5          50
7286  3636     True            6             6        6          60
7287  3637    False            7             7        7          70
7288  3638     True            8             8        8          80
7289  3639    False            9             9        9          90
7290  3640     True            0             0        0           0
7291  3641    False            1             1        1          10
7292  3642     True            2             2        2          20
7293  3643    False            3             3        3          30
7294  3644     True            4             4        4          40
7295  3645    False            5             5        5          50
7296  3646     True            6             6        6          60
7297  3647    False            7             7        7          70
7298  3648     True            8             8        8          80
7299  3649    False            9             9        9          90

      float_col  double_col date_string_col string_col  0           0.0         0.0        07/01/10          0
1           1.1        10.1        07/01/10          1
2           2.2        20.2        07/01/10          2
3           3.3        30.3        07/01/10          3
4           4.4        40.4        07/01/10          4
5           5.5        50.5        07/01/10          5
6           6.6        60.6        07/01/10          6
7           7.7        70.7        07/01/10          7
8           8.8        80.8        07/01/10          8
9           9.9        90.9        07/01/10          9
10          0.0         0.0        07/02/10          0
11          1.1        10.1        07/02/10          1
12          2.2        20.2        07/02/10          2
13          3.3        30.3        07/02/10          3
14          4.4        40.4        07/02/10          4
15          5.5        50.5        07/02/10          5
16          6.6        60.6        07/02/10          6
17          7.7        70.7        07/02/10          7
18          8.8        80.8        07/02/10          8
19          9.9        90.9        07/02/10          9
20          0.0         0.0        07/03/10          0
21          1.1        10.1        07/03/10          1
22          2.2        20.2        07/03/10          2
23          3.3        30.3        07/03/10          3
24          4.4        40.4        07/03/10          4
25          5.5        50.5        07/03/10          5
26          6.6        60.6        07/03/10          6
27          7.7        70.7        07/03/10          7
28          8.8        80.8        07/03/10          8
29          9.9        90.9        07/03/10          9
...         ...         ...             ...        ...
7270        0.0         0.0        12/29/09          0
7271        1.1        10.1        12/29/09          1
7272        2.2        20.2        12/29/09          2
7273        3.3        30.3        12/29/09          3
7274        4.4        40.4        12/29/09          4
7275        5.5        50.5        12/29/09          5
7276        6.6        60.6        12/29/09          6
7277        7.7        70.7        12/29/09          7
7278        8.8        80.8        12/29/09          8
7279        9.9        90.9        12/29/09          9
7280        0.0         0.0        12/30/09          0
7281        1.1        10.1        12/30/09          1
7282        2.2        20.2        12/30/09          2
7283        3.3        30.3        12/30/09          3
7284        4.4        40.4        12/30/09          4
7285        5.5        50.5        12/30/09          5
7286        6.6        60.6        12/30/09          6
7287        7.7        70.7        12/30/09          7
7288        8.8        80.8        12/30/09          8
7289        9.9        90.9        12/30/09          9
7290        0.0         0.0        12/31/09          0
7291        1.1        10.1        12/31/09          1
7292        2.2        20.2        12/31/09          2
7293        3.3        30.3        12/31/09          3
7294        4.4        40.4        12/31/09          4
7295        5.5        50.5        12/31/09          5
7296        6.6        60.6        12/31/09          6
7297        7.7        70.7        12/31/09          7
7298        8.8        80.8        12/31/09          8
7299        9.9        90.9        12/31/09          9

               timestamp_col  year  month  bigger_ints
0    2010-07-01 00:00:00.000  2010      7            0
1    2010-07-01 00:01:00.000  2010      7            2
2    2010-07-01 00:02:00.100  2010      7            4
3    2010-07-01 00:03:00.300  2010      7            6
4    2010-07-01 00:04:00.600  2010      7            8
5    2010-07-01 00:05:00.100  2010      7           10
6    2010-07-01 00:06:00.150  2010      7           12
7    2010-07-01 00:07:00.210  2010      7           14
8    2010-07-01 00:08:00.280  2010      7           16
9    2010-07-01 00:09:00.360  2010      7           18
10   2010-07-02 00:10:00.450  2010      7            0
11   2010-07-02 00:11:00.450  2010      7            2
12   2010-07-02 00:12:00.460  2010      7            4
13   2010-07-02 00:13:00.480  2010      7            6
14   2010-07-02 00:14:00.510  2010      7            8
15   2010-07-02 00:15:00.550  2010      7           10
16   2010-07-02 00:16:00.600  2010      7           12
17   2010-07-02 00:17:00.660  2010      7           14
18   2010-07-02 00:18:00.730  2010      7           16
19   2010-07-02 00:19:00.810  2010      7           18
20   2010-07-03 00:20:00.900  2010      7            0
21   2010-07-03 00:21:00.900  2010      7            2
22   2010-07-03 00:22:00.910  2010      7            4
23   2010-07-03 00:23:00.930  2010      7            6
24   2010-07-03 00:24:00.960  2010      7            8
25   2010-07-03 00:25:01.000  2010      7           10
26   2010-07-03 00:26:01.500  2010      7           12
27   2010-07-03 00:27:01.110  2010      7           14
28   2010-07-03 00:28:01.180  2010      7           16
29   2010-07-03 00:29:01.260  2010      7           18
...                      ...   ...    ...          ...
7270 2009-12-29 04:40:12.600  2009     12            0
7271 2009-12-29 04:41:12.600  2009     12            2
7272 2009-12-29 04:42:12.610  2009     12            4
7273 2009-12-29 04:43:12.630  2009     12            6
7274 2009-12-29 04:44:12.660  2009     12            8
7275 2009-12-29 04:45:12.700  2009     12           10
7276 2009-12-29 04:46:12.750  2009     12           12
7277 2009-12-29 04:47:12.810  2009     12           14
7278 2009-12-29 04:48:12.880  2009     12           16
7279 2009-12-29 04:49:12.960  2009     12           18
7280 2009-12-30 04:50:13.500  2009     12            0
7281 2009-12-30 04:51:13.500  2009     12            2
7282 2009-12-30 04:52:13.600  2009     12            4
7283 2009-12-30 04:53:13.800  2009     12            6
7284 2009-12-30 04:54:13.110  2009     12            8
7285 2009-12-30 04:55:13.150  2009     12           10
7286 2009-12-30 04:56:13.200  2009     12           12
7287 2009-12-30 04:57:13.260  2009     12           14
7288 2009-12-30 04:58:13.330  2009     12           16
7289 2009-12-30 04:59:13.410  2009     12           18
7290 2009-12-31 05:00:13.500  2009     12            0
7291 2009-12-31 05:01:13.500  2009     12            2
7292 2009-12-31 05:02:13.510  2009     12            4
7293 2009-12-31 05:03:13.530  2009     12            6
7294 2009-12-31 05:04:13.560  2009     12            8
7295 2009-12-31 05:05:13.600  2009     12           10
7296 2009-12-31 05:06:13.650  2009     12           12
7297 2009-12-31 05:07:13.710  2009     12           14
7298 2009-12-31 05:08:13.780  2009     12           16
7299 2009-12-31 05:09:13.860  2009     12           18

[7300 rows x 14 columns]
</pre>
<p>In more complicated projections involving joins, we may need to refer to
all of the columns in a same at once. This is how <code class="docutils literal"><span class="pre">add_column</span></code> works.
We just pass the whole table in the projection:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">table</span><span class="o">.</span><span class="n">select</span><span class="p">([</span><span class="n">table</span><span class="p">,</span> <span class="n">bigger_expr</span><span class="p">])</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<pre class="literal-block">
        id bool_col  tinyint_col  smallint_col  int_col  bigint_col  0     4550     True            0             0        0           0
1     4551    False            1             1        1          10
2     4552     True            2             2        2          20
3     4553    False            3             3        3          30
4     4554     True            4             4        4          40
5     4555    False            5             5        5          50
6     4556     True            6             6        6          60
7     4557    False            7             7        7          70
8     4558     True            8             8        8          80
9     4559    False            9             9        9          90
10    4560     True            0             0        0           0
11    4561    False            1             1        1          10
12    4562     True            2             2        2          20
13    4563    False            3             3        3          30
14    4564     True            4             4        4          40
15    4565    False            5             5        5          50
16    4566     True            6             6        6          60
17    4567    False            7             7        7          70
18    4568     True            8             8        8          80
19    4569    False            9             9        9          90
20    4570     True            0             0        0           0
21    4571    False            1             1        1          10
22    4572     True            2             2        2          20
23    4573    False            3             3        3          30
24    4574     True            4             4        4          40
25    4575    False            5             5        5          50
26    4576     True            6             6        6          60
27    4577    False            7             7        7          70
28    4578     True            8             8        8          80
29    4579    False            9             9        9          90
...    ...      ...          ...           ...      ...         ...
7270  3620     True            0             0        0           0
7271  3621    False            1             1        1          10
7272  3622     True            2             2        2          20
7273  3623    False            3             3        3          30
7274  3624     True            4             4        4          40
7275  3625    False            5             5        5          50
7276  3626     True            6             6        6          60
7277  3627    False            7             7        7          70
7278  3628     True            8             8        8          80
7279  3629    False            9             9        9          90
7280  3630     True            0             0        0           0
7281  3631    False            1             1        1          10
7282  3632     True            2             2        2          20
7283  3633    False            3             3        3          30
7284  3634     True            4             4        4          40
7285  3635    False            5             5        5          50
7286  3636     True            6             6        6          60
7287  3637    False            7             7        7          70
7288  3638     True            8             8        8          80
7289  3639    False            9             9        9          90
7290  3640     True            0             0        0           0
7291  3641    False            1             1        1          10
7292  3642     True            2             2        2          20
7293  3643    False            3             3        3          30
7294  3644     True            4             4        4          40
7295  3645    False            5             5        5          50
7296  3646     True            6             6        6          60
7297  3647    False            7             7        7          70
7298  3648     True            8             8        8          80
7299  3649    False            9             9        9          90

      float_col  double_col date_string_col string_col  0           0.0         0.0        04/01/10          0
1           1.1        10.1        04/01/10          1
2           2.2        20.2        04/01/10          2
3           3.3        30.3        04/01/10          3
4           4.4        40.4        04/01/10          4
5           5.5        50.5        04/01/10          5
6           6.6        60.6        04/01/10          6
7           7.7        70.7        04/01/10          7
8           8.8        80.8        04/01/10          8
9           9.9        90.9        04/01/10          9
10          0.0         0.0        04/02/10          0
11          1.1        10.1        04/02/10          1
12          2.2        20.2        04/02/10          2
13          3.3        30.3        04/02/10          3
14          4.4        40.4        04/02/10          4
15          5.5        50.5        04/02/10          5
16          6.6        60.6        04/02/10          6
17          7.7        70.7        04/02/10          7
18          8.8        80.8        04/02/10          8
19          9.9        90.9        04/02/10          9
20          0.0         0.0        04/03/10          0
21          1.1        10.1        04/03/10          1
22          2.2        20.2        04/03/10          2
23          3.3        30.3        04/03/10          3
24          4.4        40.4        04/03/10          4
25          5.5        50.5        04/03/10          5
26          6.6        60.6        04/03/10          6
27          7.7        70.7        04/03/10          7
28          8.8        80.8        04/03/10          8
29          9.9        90.9        04/03/10          9
...         ...         ...             ...        ...
7270        0.0         0.0        12/29/09          0
7271        1.1        10.1        12/29/09          1
7272        2.2        20.2        12/29/09          2
7273        3.3        30.3        12/29/09          3
7274        4.4        40.4        12/29/09          4
7275        5.5        50.5        12/29/09          5
7276        6.6        60.6        12/29/09          6
7277        7.7        70.7        12/29/09          7
7278        8.8        80.8        12/29/09          8
7279        9.9        90.9        12/29/09          9
7280        0.0         0.0        12/30/09          0
7281        1.1        10.1        12/30/09          1
7282        2.2        20.2        12/30/09          2
7283        3.3        30.3        12/30/09          3
7284        4.4        40.4        12/30/09          4
7285        5.5        50.5        12/30/09          5
7286        6.6        60.6        12/30/09          6
7287        7.7        70.7        12/30/09          7
7288        8.8        80.8        12/30/09          8
7289        9.9        90.9        12/30/09          9
7290        0.0         0.0        12/31/09          0
7291        1.1        10.1        12/31/09          1
7292        2.2        20.2        12/31/09          2
7293        3.3        30.3        12/31/09          3
7294        4.4        40.4        12/31/09          4
7295        5.5        50.5        12/31/09          5
7296        6.6        60.6        12/31/09          6
7297        7.7        70.7        12/31/09          7
7298        8.8        80.8        12/31/09          8
7299        9.9        90.9        12/31/09          9

               timestamp_col  year  month  bigger_ints
0    2010-04-01 00:00:00.000  2010      4            0
1    2010-04-01 00:01:00.000  2010      4            2
2    2010-04-01 00:02:00.100  2010      4            4
3    2010-04-01 00:03:00.300  2010      4            6
4    2010-04-01 00:04:00.600  2010      4            8
5    2010-04-01 00:05:00.100  2010      4           10
6    2010-04-01 00:06:00.150  2010      4           12
7    2010-04-01 00:07:00.210  2010      4           14
8    2010-04-01 00:08:00.280  2010      4           16
9    2010-04-01 00:09:00.360  2010      4           18
10   2010-04-02 00:10:00.450  2010      4            0
11   2010-04-02 00:11:00.450  2010      4            2
12   2010-04-02 00:12:00.460  2010      4            4
13   2010-04-02 00:13:00.480  2010      4            6
14   2010-04-02 00:14:00.510  2010      4            8
15   2010-04-02 00:15:00.550  2010      4           10
16   2010-04-02 00:16:00.600  2010      4           12
17   2010-04-02 00:17:00.660  2010      4           14
18   2010-04-02 00:18:00.730  2010      4           16
19   2010-04-02 00:19:00.810  2010      4           18
20   2010-04-03 00:20:00.900  2010      4            0
21   2010-04-03 00:21:00.900  2010      4            2
22   2010-04-03 00:22:00.910  2010      4            4
23   2010-04-03 00:23:00.930  2010      4            6
24   2010-04-03 00:24:00.960  2010      4            8
25   2010-04-03 00:25:01.000  2010      4           10
26   2010-04-03 00:26:01.500  2010      4           12
27   2010-04-03 00:27:01.110  2010      4           14
28   2010-04-03 00:28:01.180  2010      4           16
29   2010-04-03 00:29:01.260  2010      4           18
...                      ...   ...    ...          ...
7270 2009-12-29 04:40:12.600  2009     12            0
7271 2009-12-29 04:41:12.600  2009     12            2
7272 2009-12-29 04:42:12.610  2009     12            4
7273 2009-12-29 04:43:12.630  2009     12            6
7274 2009-12-29 04:44:12.660  2009     12            8
7275 2009-12-29 04:45:12.700  2009     12           10
7276 2009-12-29 04:46:12.750  2009     12           12
7277 2009-12-29 04:47:12.810  2009     12           14
7278 2009-12-29 04:48:12.880  2009     12           16
7279 2009-12-29 04:49:12.960  2009     12           18
7280 2009-12-30 04:50:13.500  2009     12            0
7281 2009-12-30 04:51:13.500  2009     12            2
7282 2009-12-30 04:52:13.600  2009     12            4
7283 2009-12-30 04:53:13.800  2009     12            6
7284 2009-12-30 04:54:13.110  2009     12            8
7285 2009-12-30 04:55:13.150  2009     12           10
7286 2009-12-30 04:56:13.200  2009     12           12
7287 2009-12-30 04:57:13.260  2009     12           14
7288 2009-12-30 04:58:13.330  2009     12           16
7289 2009-12-30 04:59:13.410  2009     12           18
7290 2009-12-31 05:00:13.500  2009     12            0
7291 2009-12-31 05:01:13.500  2009     12            2
7292 2009-12-31 05:02:13.510  2009     12            4
7293 2009-12-31 05:03:13.530  2009     12            6
7294 2009-12-31 05:04:13.560  2009     12            8
7295 2009-12-31 05:05:13.600  2009     12           10
7296 2009-12-31 05:06:13.650  2009     12           12
7297 2009-12-31 05:07:13.710  2009     12           14
7298 2009-12-31 05:08:13.780  2009     12           16
7299 2009-12-31 05:09:13.860  2009     12           18

[7300 rows x 14 columns]
</pre>
<p>To use constants in projections, we have to use a special
<code class="docutils literal"><span class="pre">ibis.literal</span></code> function</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">foo_constant</span> <span class="o">=</span> <span class="n">ibis</span><span class="o">.</span><span class="n">literal</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="s">&#39;foo&#39;</span><span class="p">)</span>
<span class="n">table</span><span class="o">.</span><span class="n">select</span><span class="p">([</span><span class="n">table</span><span class="o">.</span><span class="n">bigint_col</span><span class="p">,</span> <span class="n">foo_constant</span><span class="p">])</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>      bigint_col  foo
0              0    5
1             10    5
2             20    5
3             30    5
4             40    5
5             50    5
6             60    5
7             70    5
8             80    5
9             90    5
10             0    5
11            10    5
12            20    5
13            30    5
14            40    5
15            50    5
16            60    5
17            70    5
18            80    5
19            90    5
20             0    5
21            10    5
22            20    5
23            30    5
24            40    5
25            50    5
26            60    5
27            70    5
28            80    5
29            90    5
...          ...  ...
7270           0    5
7271          10    5
7272          20    5
7273          30    5
7274          40    5
7275          50    5
7276          60    5
7277          70    5
7278          80    5
7279          90    5
7280           0    5
7281          10    5
7282          20    5
7283          30    5
7284          40    5
7285          50    5
7286          60    5
7287          70    5
7288          80    5
7289          90    5
7290           0    5
7291          10    5
7292          20    5
7293          30    5
7294          40    5
7295          50    5
7296          60    5
7297          70    5
7298          80    5
7299          90    5

[7300 rows x 2 columns]
</pre></div>
</div>
</div>
<div class="section" id="joins">
<h1>Joins<a class="headerlink" href="#joins" title="Permalink to this headline">¶</a></h1>
<p>Ibis attempts to provide good support for all the standard relational
joins supported by Impala, Hive, and other relational databases.</p>
<ul class="simple">
<li>inner, outer, left, right joins</li>
<li>semi and anti-joins</li>
</ul>
<p>To illustrate the joins we&#8217;ll use the TPC-H tables for now</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">region</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="s">&#39;tpch_region&#39;</span><span class="p">)</span>
<span class="n">nation</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="s">&#39;tpch_nation&#39;</span><span class="p">)</span>
<span class="n">customer</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="s">&#39;tpch_customer&#39;</span><span class="p">)</span>
<span class="n">lineitem</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="s">&#39;tpch_lineitem&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">region</span></code> and <code class="docutils literal"><span class="pre">nation</span></code> are connected by their respective
<code class="docutils literal"><span class="pre">regionkey</span></code> columns</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">join_expr</span> <span class="o">=</span> <span class="n">region</span><span class="o">.</span><span class="n">r_regionkey</span> <span class="o">==</span> <span class="n">nation</span><span class="o">.</span><span class="n">n_regionkey</span>
<span class="n">joined</span> <span class="o">=</span> <span class="n">region</span><span class="o">.</span><span class="n">inner_join</span><span class="p">(</span><span class="n">nation</span><span class="p">,</span> <span class="n">join_expr</span><span class="p">)</span>
</pre></div>
</div>
<p>If you have multiple join conditions, either compose them yourself (like
filters) or pass a list to the join function</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">join_exprs</span> <span class="o">=</span> <span class="p">[</span><span class="n">cond1</span><span class="p">,</span> <span class="n">cond2</span><span class="p">,</span> <span class="n">cond3</span><span class="p">]</span>
<span class="n">joined</span> <span class="o">=</span> <span class="n">table1</span><span class="o">.</span><span class="n">inner_join</span><span class="p">(</span><span class="n">table2</span><span class="p">,</span> <span class="n">join_exprs</span><span class="p">)</span>
</pre></div>
</div>
<p>Once you&#8217;ve joined tables, you don&#8217;t necessarily have anything yet. I&#8217;ll
put it in big letters</p>
</div>
<div class="section" id="joins-are-declarations-of-intent">
<h1>Joins are declarations of intent<a class="headerlink" href="#joins-are-declarations-of-intent" title="Permalink to this headline">¶</a></h1>
<p>After calling the join function (which validates the join condition, of
course), you may perform any number of other operations:</p>
<ul class="simple">
<li>Aggregation</li>
<li>Projection</li>
<li>Filtering</li>
</ul>
<p>and so forth. Most importantly, depending on your schemas, the joined
tables may include overlapping column names that could create a conflict
if not addressed directly. Some other systems, like pandas, handle this
by applying suffixes to the overlapping column names and computing the
fully joined tables immediately. We don&#8217;t do this.</p>
<p>So, with the above data, suppose we just want the region name and all
the nation table data. We can then make a projection on the joined
reference:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">table_ref</span> <span class="o">=</span> <span class="n">joined</span><span class="p">[</span><span class="n">nation</span><span class="p">,</span> <span class="n">region</span><span class="o">.</span><span class="n">r_name</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="s">&#39;region&#39;</span><span class="p">)]</span>
<span class="n">table_ref</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[</span><span class="s">&#39;n_nationkey&#39;</span><span class="p">,</span> <span class="s">&#39;n_name&#39;</span><span class="p">,</span> <span class="s">&#39;n_regionkey&#39;</span><span class="p">,</span> <span class="s">&#39;n_comment&#39;</span><span class="p">,</span> <span class="s">&#39;region&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">table_ref</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<pre class="literal-block">
    n_nationkey          n_name  n_regionkey  0             0         ALGERIA            0
1             1       ARGENTINA            1
2             2          BRAZIL            1
3             3          CANADA            1
4             4           EGYPT            4
5             5        ETHIOPIA            0
6             6          FRANCE            3
7             7         GERMANY            3
8             8           INDIA            2
9             9       INDONESIA            2
10           10            IRAN            4
11           11            IRAQ            4
12           12           JAPAN            2
13           13          JORDAN            4
14           14           KENYA            0
15           15         MOROCCO            0
16           16      MOZAMBIQUE            0
17           17            PERU            1
18           18           CHINA            2
19           19         ROMANIA            3
20           20    SAUDI ARABIA            4
21           21         VIETNAM            2
22           22          RUSSIA            3
23           23  UNITED KINGDOM            3
24           24   UNITED STATES            1

                                            n_comment       region
0    haggle. carefully final deposits detect slyly...       AFRICA
1   al foxes promise slyly according to the regula...      AMERICA
2   y alongside of the pending deposits. carefully...      AMERICA
3   eas hang ironic, silent packages. slyly regula...      AMERICA
4   y above the carefully unusual theodolites. fin...  MIDDLE EAST
5                     ven packages wake quickly. regu       AFRICA
6              refully final requests. regular, ironi       EUROPE
7   l platelets. regular accounts x-ray: unusual, ...       EUROPE
8   ss excuses cajole slyly across the packages. d...         ASIA
9    slyly express asymptotes. regular deposits ha...         ASIA
10  efully alongside of the slyly final dependenci...  MIDDLE EAST
11  nic deposits boost atop the quickly final requ...  MIDDLE EAST
12               ously. final, express gifts cajole a         ASIA
13  ic deposits are blithely about the carefully r...  MIDDLE EAST
14   pending excuses haggle furiously deposits. pe...       AFRICA
15  rns. blithely bold courts among the closely re...       AFRICA
16      s. ironic, unusual asymptotes wake blithely r       AFRICA
17  platelets. blithely pending dependencies use f...      AMERICA
18  c dependencies. furiously express notornis sle...         ASIA
19  ular asymptotes are about the furious multipli...       EUROPE
20  ts. silent requests haggle. closely express pa...  MIDDLE EAST
21     hely enticingly express accounts. even, final          ASIA
22   requests against the platelets use never acco...       EUROPE
23  eans boost carefully special requests. account...       EUROPE
24  y final packages. slow foxes cajole quickly. q...      AMERICA
</pre>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">agged</span> <span class="o">=</span> <span class="n">table_ref</span><span class="o">.</span><span class="n">aggregate</span><span class="p">([</span><span class="n">table_ref</span><span class="o">.</span><span class="n">n_name</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="s">&#39;nrows&#39;</span><span class="p">)],</span> <span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;region&#39;</span><span class="p">])</span>
<span class="n">agged</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>        region  nrows
0       EUROPE      5
1      AMERICA      5
2  MIDDLE EAST      5
3         ASIA      5
4       AFRICA      5
</pre></div>
</div>
<p>Things like <code class="docutils literal"><span class="pre">group_by</span></code> work with unmaterialized joins, too, as you
would hope.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">joined</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="n">region</span><span class="o">.</span><span class="n">r_name</span><span class="p">)</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>        r_name  count
0       AFRICA      5
1  MIDDLE EAST      5
2      AMERICA      5
3         ASIA      5
4       EUROPE      5
</pre></div>
</div>
</div>
<div class="section" id="explicit-join-materialization">
<h1>Explicit join materialization<a class="headerlink" href="#explicit-join-materialization" title="Permalink to this headline">¶</a></h1>
<p>If you&#8217;re lucky enough to have two table schemas with no overlapping
column names (lucky you!), the join can be <em>materialized</em> without having
to perform some other relational algebra operation:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">joined</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">inner_join</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">join_expr</span><span class="p">)</span><span class="o">.</span><span class="n">materialize</span><span class="p">()</span>
</pre></div>
</div>
<p>Note that this is equivalent to doing</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">joined</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">b</span><span class="p">)[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">]</span>
</pre></div>
</div>
<p>i.e., joining and then selecting all columns from both joined tables. If
there is a name overlap, just like with the equivalent projection, there
will be an immediate error.</p>
</div>
<div class="section" id="writing-down-join-keys">
<h1>Writing down join keys<a class="headerlink" href="#writing-down-join-keys" title="Permalink to this headline">¶</a></h1>
<p>In addition to having explicit comparison expressions as join keys, you
can also write down column names, or use expressions referencing the
joined tables, e.g.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">joined</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;a_key1&#39;</span><span class="p">,</span> <span class="s">&#39;b_key2&#39;</span><span class="p">)])</span>

<span class="n">joined2</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="p">[(</span><span class="n">left_expr</span><span class="p">,</span> <span class="n">right_expr</span><span class="p">)])</span>

<span class="n">joined3</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;common_key&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>These will be compared for equality when performing the join; if you
want non-equality conditions in the join, you will have to form those
yourself.</p>
</div>
<div class="section" id="join-referential-nuances">
<h1>Join referential nuances<a class="headerlink" href="#join-referential-nuances" title="Permalink to this headline">¶</a></h1>
<p>There&#8217;s nothing to stop you from doing many joins in succession, and, in
fact, with complex schemas it will be to your advantage to build the
joined table references for your analysis first, then reuse the objects
as you go:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">joined_ref</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">key1</span> <span class="o">==</span> <span class="n">b</span><span class="o">.</span><span class="n">key2</span><span class="p">)</span>
               <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">key3</span> <span class="o">==</span> <span class="n">c</span><span class="o">.</span><span class="n">key4</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">key5</span> <span class="o">==</span> <span class="n">c</span><span class="o">.</span><span class="n">key6</span><span class="p">]))</span>
</pre></div>
</div>
<p>Note that, at least right now, you need to provide explicit comparison
expressions (or tuples of column references) referencing the joined
tables.</p>
</div>
<div class="section" id="aggregating-joined-table-with-metrics-involving-more-than-one-base-reference">
<h1>Aggregating joined table with metrics involving more than one base reference<a class="headerlink" href="#aggregating-joined-table-with-metrics-involving-more-than-one-base-reference" title="Permalink to this headline">¶</a></h1>
<p>Let&#8217;s consider the case similar to the SQL query</p>
<div class="highlight-python"><div class="highlight"><pre>SELECT a.key, sum(a.foo - b.bar) AS metric
FROM a
  JOIN b
    ON a.key = b.key
GROUP BY 1
</pre></div>
</div>
<p>I&#8217;ll use a somewhat contrived example using the data we already have to
show you what this looks like. Take the <code class="docutils literal"><span class="pre">functional.alltypes</span></code> table,
and suppose we want to compute the <strong>mean absolute deviation (MAD) from
the hourly mean of the double_col</strong>. Silly, I know, but bear with me.</p>
<p>First, the hourly mean:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">table</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="s">&#39;functional_alltypes&#39;</span><span class="p">)</span>

<span class="n">hour_dim</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">timestamp_col</span><span class="o">.</span><span class="n">hour</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="s">&#39;hour&#39;</span><span class="p">)</span>

<span class="n">hourly_mean</span> <span class="o">=</span> <span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="n">hour_dim</span><span class="p">)</span>
               <span class="o">.</span><span class="n">aggregate</span><span class="p">([</span><span class="n">table</span><span class="o">.</span><span class="n">double_col</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="s">&#39;avg_double&#39;</span><span class="p">)]))</span>
<span class="n">hourly_mean</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>   hour  avg_double
0     4       45.45
1     2       45.45
2     0       45.45
3     3       45.45
4     1       45.45
5     5       45.45
</pre></div>
</div>
<p>Okay, great, now how about the MAD? The only trick here is that we can
form an aggregate metric from the two tables, and we then have to join
it later. Ibis <strong>will not</strong> figure out how to join the tables
automatically for us.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">mad</span> <span class="o">=</span> <span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">double_col</span> <span class="o">-</span> <span class="n">hourly_mean</span><span class="o">.</span><span class="n">avg_double</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="s">&#39;MAD&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>This metric is only valid if used in the context of <code class="docutils literal"><span class="pre">table</span></code> joined
with <code class="docutils literal"><span class="pre">hourly_mean</span></code>, so let&#8217;s do that. Writing down the join condition
is seriously a matter of writing:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">join_expr</span> <span class="o">=</span> <span class="n">hour_dim</span> <span class="o">==</span> <span class="n">hourly_mean</span><span class="o">.</span><span class="n">hour</span>
</pre></div>
</div>
<p>Now let&#8217;s compute the MAD grouped by <code class="docutils literal"><span class="pre">string_col</span></code></p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">inner_join</span><span class="p">(</span><span class="n">hourly_mean</span><span class="p">,</span> <span class="n">join_expr</span><span class="p">)</span>
          <span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">string_col</span><span class="p">)</span>
          <span class="o">.</span><span class="n">aggregate</span><span class="p">([</span><span class="n">mad</span><span class="p">]))</span>
<span class="n">result</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>  string_col    mad
0          7  25.25
1          6  15.15
2          2  25.25
3          4   5.05
4          8  35.35
5          0  45.45
6          3  15.15
7          5   5.05
8          1  35.35
9          9  45.45
</pre></div>
</div>
</div>
<div class="section" id="sorting">
<h1>Sorting<a class="headerlink" href="#sorting" title="Permalink to this headline">¶</a></h1>
<p>Sorting tables works similarly to the SQL <code class="docutils literal"><span class="pre">ORDER</span> <span class="pre">BY</span></code> clause. We use
the <code class="docutils literal"><span class="pre">sort_by</span></code> function and pass one of the following:</p>
<ul class="simple">
<li>Column names</li>
<li>Column expressions</li>
<li>One of these, with a False (descending order) or True (ascending
order) qualifier</li>
</ul>
<p>So, to sort by <code class="docutils literal"><span class="pre">total</span></code> in ascending order we write:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">table</span><span class="o">.</span><span class="n">sort_by</span><span class="p">(</span><span class="s">&#39;total&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>or by <code class="docutils literal"><span class="pre">key</span></code> then by <code class="docutils literal"><span class="pre">total</span></code> in descending order</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">table</span><span class="o">.</span><span class="n">sort_by</span><span class="p">([</span><span class="s">&#39;key&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s">&#39;total&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">)])</span>
</pre></div>
</div>
<p>For descending sort order, there is a convenience function <code class="docutils literal"><span class="pre">desc</span></code>
which can wrap sort keys</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">ibis</span> <span class="kn">import</span> <span class="n">desc</span>
<span class="n">table</span><span class="o">.</span><span class="n">sort_by</span><span class="p">([</span><span class="s">&#39;key&#39;</span><span class="p">,</span> <span class="n">desc</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">total</span><span class="p">)])</span>
</pre></div>
</div>
<p>Here&#8217;s a concrete example involving filters, custom grouping dimension,
and sorting</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">table</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="s">&#39;functional_alltypes&#39;</span><span class="p">)</span>

<span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;string_col&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">bigint_col</span> <span class="o">&gt;</span> <span class="mi">40</span><span class="p">)</span><span class="o">.</span><span class="n">ifelse</span><span class="p">(</span><span class="s">&#39;high&#39;</span><span class="p">,</span> <span class="s">&#39;low&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="s">&#39;bigint_tier&#39;</span><span class="p">)]</span>
<span class="n">metrics</span> <span class="o">=</span> <span class="p">[</span><span class="n">table</span><span class="o">.</span><span class="n">double_col</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="s">&#39;total&#39;</span><span class="p">)]</span>

<span class="n">agged</span> <span class="o">=</span> <span class="p">(</span><span class="n">table</span>
         <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">int_col</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="p">)</span>
         <span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span>
         <span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="n">metrics</span><span class="p">))</span>

<span class="n">sorted_agged</span> <span class="o">=</span> <span class="n">agged</span><span class="o">.</span><span class="n">sort_by</span><span class="p">([</span><span class="s">&#39;bigint_tier&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s">&#39;total&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">)])</span>
<span class="n">sorted_agged</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>  string_col bigint_tier  total
0          7        high  51611
1          6        high  44238
2          5        high  36865
3          4         low  29492
4          3         low  22119
5          2         low  14746
6          1         low   7373
7          0         low      0
</pre></div>
</div>
<p>For sorting in descending order, you can use the special <code class="docutils literal"><span class="pre">ibis.desc</span></code>
function:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">agged</span><span class="o">.</span><span class="n">sort_by</span><span class="p">(</span><span class="n">ibis</span><span class="o">.</span><span class="n">desc</span><span class="p">(</span><span class="s">&#39;total&#39;</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>  string_col bigint_tier  total
0          7        high  51611
1          6        high  44238
2          5        high  36865
3          4         low  29492
4          3         low  22119
5          2         low  14746
6          1         low   7373
7          0         low      0
</pre></div>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="3.html" class="btn btn-neutral float-right" title="Type casting">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="1.html" class="btn btn-neutral" title="Basics: Aggregation, filtering, limits"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Cloudera, Inc..
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.3.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  
 
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-65303298-2', 'auto');
  ga('send', 'pageview');

</script>


</body>
</html>