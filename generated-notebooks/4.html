

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Creating new Impala tables from Ibis expressions &mdash; Ibis v0.7.1+17.g3bc20c0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Ibis v0.7.1+17.g3bc20c0 documentation" href="../index.html"/>
        <link rel="up" title="Expression tutorial" href="../tutorial.html"/>
        <link rel="next" title="“Top-K” Filtering" href="5.html"/>
        <link rel="prev" title="Type casting" href="3.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Ibis
          

          
          </a>

          
            
            
              <div class="version">
                v0.7.1+17.g3bc20c0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting-started.html">Installation and Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration.html">Configuring Ibis</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../tutorial.html">Expression tutorial</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="0.html">Impala/HDFS intro and Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="1.html">Basics: Aggregation, filtering, limits</a></li>
<li class="toctree-l2"><a class="reference internal" href="2.html">Projections: adding/selecting columns</a></li>
<li class="toctree-l2"><a class="reference internal" href="2.html#joins">Joins</a></li>
<li class="toctree-l2"><a class="reference internal" href="2.html#sorting">Sorting</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.html">Type casting</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.html#case-if-then-else-expressions">Case / if-then-else expressions</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.html#set-membership">Set membership</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.html#null-ness">Null-ness</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.html#distinct-based-operations">Distinct-based operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.html#string-operations">String operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.html#timestamp-operations">Timestamp operations</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Creating new Impala tables from Ibis expressions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#inserting-data-into-existing-impala-tables">Inserting data into existing Impala tables</a></li>
<li class="toctree-l2"><a class="reference internal" href="#uploading-downloading-data-from-hdfs">Uploading / downloading data from HDFS</a></li>
<li class="toctree-l2"><a class="reference internal" href="#queries-on-parquet-avro-and-delimited-files-in-hdfs">Queries on Parquet, Avro, and Delimited files in HDFS</a></li>
<li class="toctree-l2"><a class="reference internal" href="#other-helper-functions-for-interacting-with-the-database">Other helper functions for interacting with the database</a></li>
<li class="toctree-l2"><a class="reference internal" href="#dealing-with-partitioned-tables-in-impala">Dealing with Partitioned tables in Impala</a></li>
<li class="toctree-l2"><a class="reference internal" href="#faster-queries-on-small-data-in-impala">Faster queries on small data in Impala</a></li>
<li class="toctree-l2"><a class="reference internal" href="5.html">&#8220;Top-K&#8221; Filtering</a></li>
<li class="toctree-l2"><a class="reference internal" href="5.html#self-joins">Self joins</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../impala.html">Using Ibis with Impala</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sql.html">Ibis for SQL Programmers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer.html">Developing and Contributing to Ibis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../type-system.html">Ibis design internals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../legal.html">Legal</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">Ibis</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../tutorial.html">Expression tutorial</a> &raquo;</li>
      
    <li>Creating new Impala tables from Ibis expressions</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/generated-notebooks/4.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">ibis</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">hdfs_port</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;IBIS_WEBHDFS_PORT&#39;</span><span class="p">,</span> <span class="mi">50070</span><span class="p">)</span>
<span class="n">hdfs</span> <span class="o">=</span> <span class="n">ibis</span><span class="o">.</span><span class="n">hdfs_connect</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;quickstart.cloudera&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="n">hdfs_port</span><span class="p">)</span>
<span class="n">con</span> <span class="o">=</span> <span class="n">ibis</span><span class="o">.</span><span class="n">impala</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;quickstart.cloudera&#39;</span><span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="s1">&#39;ibis_testing&#39;</span><span class="p">,</span>
                          <span class="n">hdfs_client</span><span class="o">=</span><span class="n">hdfs</span><span class="p">)</span>
<span class="n">ibis</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">interactive</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
<div class="section" id="creating-new-impala-tables-from-ibis-expressions">
<h1>Creating new Impala tables from Ibis expressions<a class="headerlink" href="#creating-new-impala-tables-from-ibis-expressions" title="Permalink to this headline">¶</a></h1>
<p>Suppose you have an Ibis expression that produces a table:</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">table</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="s1">&#39;functional_alltypes&#39;</span><span class="p">)</span>

<span class="n">t2</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="n">table</span><span class="p">,</span> <span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">bigint_col</span> <span class="o">-</span> <span class="n">table</span><span class="o">.</span><span class="n">int_col</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">)]</span>

<span class="n">expr</span> <span class="o">=</span> <span class="p">(</span><span class="n">t2</span>
        <span class="p">[</span><span class="n">t2</span><span class="o">.</span><span class="n">bigint_col</span> <span class="o">&gt;</span> <span class="mi">30</span><span class="p">]</span>
        <span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="s1">&#39;string_col&#39;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">aggregate</span><span class="p">([</span><span class="n">t2</span><span class="o">.</span><span class="n">foo</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="s1">&#39;min_foo&#39;</span><span class="p">),</span>
                    <span class="n">t2</span><span class="o">.</span><span class="n">foo</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="s1">&#39;max_foo&#39;</span><span class="p">),</span>
                    <span class="n">t2</span><span class="o">.</span><span class="n">foo</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="s1">&#39;sum_foo&#39;</span><span class="p">)]))</span>
<span class="n">expr</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span>  <span class="n">string_col</span>  <span class="n">min_foo</span>  <span class="n">max_foo</span>  <span class="n">sum_foo</span>
<span class="mi">0</span>          <span class="mi">6</span>       <span class="mi">54</span>       <span class="mi">54</span>    <span class="mi">39420</span>
<span class="mi">1</span>          <span class="mi">4</span>       <span class="mi">36</span>       <span class="mi">36</span>    <span class="mi">26280</span>
<span class="mi">2</span>          <span class="mi">7</span>       <span class="mi">63</span>       <span class="mi">63</span>    <span class="mi">45990</span>
<span class="mi">3</span>          <span class="mi">8</span>       <span class="mi">72</span>       <span class="mi">72</span>    <span class="mi">52560</span>
<span class="mi">4</span>          <span class="mi">5</span>       <span class="mi">45</span>       <span class="mi">45</span>    <span class="mi">32850</span>
<span class="mi">5</span>          <span class="mi">9</span>       <span class="mi">81</span>       <span class="mi">81</span>    <span class="mi">59130</span>
</pre></div>
</div>
<p>To create a table in the database from the results of this expression,
use the connection&#8217;s <code class="docutils literal"><span class="pre">create_table</span></code> method:</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">con</span><span class="o">.</span><span class="n">create_table</span><span class="p">(</span><span class="s1">&#39;testing_table&#39;</span><span class="p">,</span> <span class="n">expr</span><span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="s1">&#39;ibis_testing&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>By default, this creates a table stored as <strong>Parquet format</strong> in HDFS.
Support for views, external tables, configurable file formats, and so
forth, will come in the future. Feedback on what kind of interface would
be useful for that would help.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">con</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="s1">&#39;testing_table&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span>  <span class="n">string_col</span>  <span class="n">min_foo</span>  <span class="n">max_foo</span>  <span class="n">sum_foo</span>
<span class="mi">0</span>          <span class="mi">9</span>       <span class="mi">81</span>       <span class="mi">81</span>    <span class="mi">59130</span>
<span class="mi">1</span>          <span class="mi">8</span>       <span class="mi">72</span>       <span class="mi">72</span>    <span class="mi">52560</span>
<span class="mi">2</span>          <span class="mi">5</span>       <span class="mi">45</span>       <span class="mi">45</span>    <span class="mi">32850</span>
<span class="mi">3</span>          <span class="mi">6</span>       <span class="mi">54</span>       <span class="mi">54</span>    <span class="mi">39420</span>
<span class="mi">4</span>          <span class="mi">4</span>       <span class="mi">36</span>       <span class="mi">36</span>    <span class="mi">26280</span>
<span class="mi">5</span>          <span class="mi">7</span>       <span class="mi">63</span>       <span class="mi">63</span>    <span class="mi">45990</span>
</pre></div>
</div>
<p>Tables can be similarly dropped with <code class="docutils literal"><span class="pre">drop_table</span></code></p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">con</span><span class="o">.</span><span class="n">drop_table</span><span class="p">(</span><span class="s1">&#39;testing_table&#39;</span><span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="s1">&#39;ibis_testing&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="inserting-data-into-existing-impala-tables">
<h1>Inserting data into existing Impala tables<a class="headerlink" href="#inserting-data-into-existing-impala-tables" title="Permalink to this headline">¶</a></h1>
<p>The client&#8217;s <code class="docutils literal"><span class="pre">insert</span></code> method can append new data to an existing table
or overwrite the data that is in there.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">con</span><span class="o">.</span><span class="n">create_table</span><span class="p">(</span><span class="s1">&#39;testing_table&#39;</span><span class="p">,</span> <span class="n">expr</span><span class="p">)</span>
<span class="n">con</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="s1">&#39;testing_table&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span>  <span class="n">string_col</span>  <span class="n">min_foo</span>  <span class="n">max_foo</span>  <span class="n">sum_foo</span>
<span class="mi">0</span>          <span class="mi">8</span>       <span class="mi">72</span>       <span class="mi">72</span>    <span class="mi">52560</span>
<span class="mi">1</span>          <span class="mi">5</span>       <span class="mi">45</span>       <span class="mi">45</span>    <span class="mi">32850</span>
<span class="mi">2</span>          <span class="mi">6</span>       <span class="mi">54</span>       <span class="mi">54</span>    <span class="mi">39420</span>
<span class="mi">3</span>          <span class="mi">4</span>       <span class="mi">36</span>       <span class="mi">36</span>    <span class="mi">26280</span>
<span class="mi">4</span>          <span class="mi">7</span>       <span class="mi">63</span>       <span class="mi">63</span>    <span class="mi">45990</span>
<span class="mi">5</span>          <span class="mi">9</span>       <span class="mi">81</span>       <span class="mi">81</span>    <span class="mi">59130</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">con</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s1">&#39;testing_table&#39;</span><span class="p">,</span> <span class="n">expr</span><span class="p">)</span>
<span class="n">con</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="s1">&#39;testing_table&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span>   <span class="n">string_col</span>  <span class="n">min_foo</span>  <span class="n">max_foo</span>  <span class="n">sum_foo</span>
<span class="mi">0</span>           <span class="mi">9</span>       <span class="mi">81</span>       <span class="mi">81</span>    <span class="mi">59130</span>
<span class="mi">1</span>           <span class="mi">6</span>       <span class="mi">54</span>       <span class="mi">54</span>    <span class="mi">39420</span>
<span class="mi">2</span>           <span class="mi">4</span>       <span class="mi">36</span>       <span class="mi">36</span>    <span class="mi">26280</span>
<span class="mi">3</span>           <span class="mi">7</span>       <span class="mi">63</span>       <span class="mi">63</span>    <span class="mi">45990</span>
<span class="mi">4</span>           <span class="mi">8</span>       <span class="mi">72</span>       <span class="mi">72</span>    <span class="mi">52560</span>
<span class="mi">5</span>           <span class="mi">5</span>       <span class="mi">45</span>       <span class="mi">45</span>    <span class="mi">32850</span>
<span class="mi">6</span>           <span class="mi">9</span>       <span class="mi">81</span>       <span class="mi">81</span>    <span class="mi">59130</span>
<span class="mi">7</span>           <span class="mi">8</span>       <span class="mi">72</span>       <span class="mi">72</span>    <span class="mi">52560</span>
<span class="mi">8</span>           <span class="mi">5</span>       <span class="mi">45</span>       <span class="mi">45</span>    <span class="mi">32850</span>
<span class="mi">9</span>           <span class="mi">6</span>       <span class="mi">54</span>       <span class="mi">54</span>    <span class="mi">39420</span>
<span class="mi">10</span>          <span class="mi">4</span>       <span class="mi">36</span>       <span class="mi">36</span>    <span class="mi">26280</span>
<span class="mi">11</span>          <span class="mi">7</span>       <span class="mi">63</span>       <span class="mi">63</span>    <span class="mi">45990</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">con</span><span class="o">.</span><span class="n">drop_table</span><span class="p">(</span><span class="s1">&#39;testing_table&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="uploading-downloading-data-from-hdfs">
<h1>Uploading / downloading data from HDFS<a class="headerlink" href="#uploading-downloading-data-from-hdfs" title="Permalink to this headline">¶</a></h1>
<p>If you&#8217;ve set up an HDFS connection, you can use the Ibis HDFS interface
to look through your data and read and write files to and from HDFS:</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">hdfs</span><span class="o">.</span><span class="n">ls</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">u&#39;__ibis&#39;</span><span class="p">,</span> <span class="s1">u&#39;hbase&#39;</span><span class="p">,</span> <span class="s1">u&#39;home&#39;</span><span class="p">,</span> <span class="s1">u&#39;test-warehouse&#39;</span><span class="p">,</span> <span class="s1">u&#39;tmp&#39;</span><span class="p">,</span> <span class="s1">u&#39;user&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">hdfs</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">hdfs</span>
<span class="n">hdfs</span><span class="o">.</span><span class="n">ls</span><span class="p">(</span><span class="s1">&#39;/__ibis/ibis-testing-data&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">u&#39;avro&#39;</span><span class="p">,</span> <span class="s1">u&#39;csv&#39;</span><span class="p">,</span> <span class="s1">u&#39;ibis_testing.db&#39;</span><span class="p">,</span> <span class="s1">u&#39;parquet&#39;</span><span class="p">,</span> <span class="s1">u&#39;udf&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">hdfs</span><span class="o">.</span><span class="n">ls</span><span class="p">(</span><span class="s1">&#39;/__ibis/ibis-testing-data/parquet&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">u&#39;functional_alltypes&#39;</span><span class="p">,</span>
 <span class="s1">u&#39;tpch_ctas_cancel&#39;</span><span class="p">,</span>
 <span class="s1">u&#39;tpch_customer&#39;</span><span class="p">,</span>
 <span class="s1">u&#39;tpch_lineitem&#39;</span><span class="p">,</span>
 <span class="s1">u&#39;tpch_nation&#39;</span><span class="p">,</span>
 <span class="s1">u&#39;tpch_orders&#39;</span><span class="p">,</span>
 <span class="s1">u&#39;tpch_part&#39;</span><span class="p">,</span>
 <span class="s1">u&#39;tpch_partsupp&#39;</span><span class="p">,</span>
 <span class="s1">u&#39;tpch_region&#39;</span><span class="p">,</span>
 <span class="s1">u&#39;tpch_supplier&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>Suppose we wanted to download
<code class="docutils literal"><span class="pre">/__ibis/ibis-testing-data/parquet/functional_alltypes</span></code>, which is a
directory. We need only do:</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span>!rm -rf parquet_dir/
hdfs.get(&#39;/__ibis/ibis-testing-data/parquet/functional_alltypes&#39;, &#39;parquet_dir&#39;)
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="s1">&#39;/home/wesm/code/ibis-notebooks/basic-tutorial/parquet_dir&#39;</span>
</pre></div>
</div>
<p>Now we have that directory locally:</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span>!ls parquet_dir/
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mi">244</span><span class="n">b1a31ffc1d401</span><span class="o">-</span><span class="mi">54</span><span class="n">bea73c44789d_884230467_data</span><span class="o">.</span><span class="mf">0.</span><span class="n">parq</span>
<span class="mi">244</span><span class="n">b1a31ffc1d401</span><span class="o">-</span><span class="mi">54</span><span class="n">bea73c44789e_1434316465_data</span><span class="o">.</span><span class="mf">0.</span><span class="n">parq</span>
<span class="mi">244</span><span class="n">b1a31ffc1d401</span><span class="o">-</span><span class="mi">54</span><span class="n">bea73c44789f_1434316465_data</span><span class="o">.</span><span class="mf">0.</span><span class="n">parq</span>
</pre></div>
</div>
<p>Files and directories can be written to HDFS just as easily using
<code class="docutils literal"><span class="pre">put</span></code>:</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;/__ibis/dir-write-example&#39;</span>
<span class="k">if</span> <span class="n">hdfs</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
    <span class="n">hdfs</span><span class="o">.</span><span class="n">rmdir</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="n">hdfs</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;parquet_dir&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="s1">&#39;/__ibis/dir-write-example&#39;</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">hdfs</span><span class="o">.</span><span class="n">ls</span><span class="p">(</span><span class="s1">&#39;/__ibis/dir-write-example&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">u&#39;244b1a31ffc1d401-54bea73c44789d_884230467_data.0.parq&#39;</span><span class="p">,</span>
 <span class="s1">u&#39;244b1a31ffc1d401-54bea73c44789e_1434316465_data.0.parq&#39;</span><span class="p">,</span>
 <span class="s1">u&#39;244b1a31ffc1d401-54bea73c44789f_1434316465_data.0.parq&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>Delete files with <code class="docutils literal"><span class="pre">rm</span></code> or directories with <code class="docutils literal"><span class="pre">rmdir</span></code>:</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">hdfs</span><span class="o">.</span><span class="n">rmdir</span><span class="p">(</span><span class="s1">&#39;/__ibis/dir-write-example&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span>!rm -rf parquet_dir/
</pre></div>
</div>
</div>
<div class="section" id="queries-on-parquet-avro-and-delimited-files-in-hdfs">
<h1>Queries on Parquet, Avro, and Delimited files in HDFS<a class="headerlink" href="#queries-on-parquet-avro-and-delimited-files-in-hdfs" title="Permalink to this headline">¶</a></h1>
<p>Ibis can easily create temporary or persistent Impala tables that
reference data in the following formats:</p>
<ul class="simple">
<li>Parquet (<code class="docutils literal"><span class="pre">parquet_file</span></code>)</li>
<li>Avro (<code class="docutils literal"><span class="pre">avro_file</span></code>)</li>
<li>Delimited text formats (CSV, TSV, etc.) (<code class="docutils literal"><span class="pre">delimited_file</span></code>)</li>
</ul>
<p>Parquet is the easiest because the schema can be read from the data
files:</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;/__ibis/ibis-testing-data/parquet/tpch_lineitem&#39;</span>

<span class="n">lineitem</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">parquet_file</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="n">lineitem</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<pre class="literal-block">
   l_orderkey  l_partkey  l_suppkey  l_linenumber l_quantity l_extendedprice  0           1     155190       7706             1      17.00        21168.23
1           1      67310       7311             2      36.00        45983.16

  l_discount l_tax l_returnflag l_linestatus  l_shipdate l_commitdate  0       0.04  0.02            N            O  1996-03-13   1996-02-12
1       0.09  0.06            N            O  1996-04-12   1996-02-28

  l_receiptdate     l_shipinstruct l_shipmode  0    1996-03-22  DELIVER IN PERSON      TRUCK
1    1996-04-20   TAKE BACK RETURN       MAIL

                            l_comment
0             egular courts above the
1  ly final dependencies: slyly bold
</pre>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">lineitem</span><span class="o">.</span><span class="n">l_extendedprice</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;229577310901.20&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>If you want to query a Parquet file and also create a table in Impala
that remains after your session, you can pass more information to
<code class="docutils literal"><span class="pre">parquet_file</span></code>:</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">table</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">parquet_file</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;my_parquet_table&#39;</span><span class="p">,</span>
                         <span class="n">database</span><span class="o">=</span><span class="s1">&#39;ibis_testing&#39;</span><span class="p">,</span>
                         <span class="n">persist</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">table</span><span class="o">.</span><span class="n">l_extendedprice</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;229577310901.20&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">con</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="s1">&#39;my_parquet_table&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">l_extendedprice</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;229577310901.20&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">con</span><span class="o">.</span><span class="n">drop_table</span><span class="p">(</span><span class="s1">&#39;my_parquet_table&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>To query delimited files, you need to write down an Ibis schema. At some
point we&#8217;d like to build some helper tools that will infer the schema
for you, all in good time.</p>
<p>There&#8217;s some CSV files in the test folder, so let&#8217;s use those:</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">hdfs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;/__ibis/ibis-testing-data/csv&#39;</span><span class="p">,</span> <span class="s1">&#39;csv-files&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="s1">&#39;/home/wesm/code/ibis-notebooks/basic-tutorial/csv-files&#39;</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span>!cat csv-files/0.csv
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">uXpivkAYSO</span><span class="p">,</span><span class="mf">1.01994339956</span><span class="p">,</span><span class="mi">27</span>
<span class="n">BcIteg32mR</span><span class="p">,</span><span class="o">-</span><span class="mf">0.497745040687</span><span class="p">,</span><span class="mi">11</span>
<span class="mi">5</span><span class="n">TZQvBHcwI</span><span class="p">,</span><span class="o">-</span><span class="mf">0.26731402764</span><span class="p">,</span><span class="mi">84</span>
<span class="n">XX8upUlbDe</span><span class="p">,</span><span class="o">-</span><span class="mf">0.0709191028435</span><span class="p">,</span><span class="mi">96</span>
<span class="n">sJdk6chNnx</span><span class="p">,</span><span class="o">-</span><span class="mf">0.27102973984</span><span class="p">,</span><span class="mi">60</span>
<span class="n">NTVYJb1d7D</span><span class="p">,</span><span class="o">-</span><span class="mf">1.23610658876</span><span class="p">,</span><span class="mi">14</span>
<span class="mi">3</span><span class="n">pX0MQsLIz</span><span class="p">,</span><span class="o">-</span><span class="mf">0.737931321383</span><span class="p">,</span><span class="mi">16</span>
<span class="n">IpNIwdTK4P</span><span class="p">,</span><span class="o">-</span><span class="mf">0.293743595331</span><span class="p">,</span><span class="mi">23</span>
<span class="n">ucIvA79467</span><span class="p">,</span><span class="mf">0.0707646026785</span><span class="p">,</span><span class="mi">12</span>
<span class="n">JIunzB1CZs</span><span class="p">,</span><span class="o">-</span><span class="mf">1.1253763919</span><span class="p">,</span><span class="mi">4</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span>!rm -rf csv-files/
</pre></div>
</div>
<p>The schema here is pretty simple (see <code class="docutils literal"><span class="pre">ibis.schema</span></code> for more):</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">schema</span> <span class="o">=</span> <span class="n">ibis</span><span class="o">.</span><span class="n">schema</span><span class="p">([(</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;string&#39;</span><span class="p">),</span>
                      <span class="p">(</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="s1">&#39;double&#39;</span><span class="p">),</span>
                      <span class="p">(</span><span class="s1">&#39;baz&#39;</span><span class="p">,</span> <span class="s1">&#39;int32&#39;</span><span class="p">)])</span>

<span class="n">table</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">delimited_file</span><span class="p">(</span><span class="s1">&#39;/__ibis/ibis-testing-data/csv&#39;</span><span class="p">,</span>
                           <span class="n">schema</span><span class="p">)</span>
<span class="n">table</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span>          <span class="n">foo</span>       <span class="n">bar</span>  <span class="n">baz</span>
<span class="mi">0</span>  <span class="n">uXpivkAYSO</span>  <span class="mf">1.019943</span>   <span class="mi">27</span>
<span class="mi">1</span>  <span class="n">BcIteg32mR</span> <span class="o">-</span><span class="mf">0.497745</span>   <span class="mi">11</span>
<span class="mi">2</span>  <span class="mi">5</span><span class="n">TZQvBHcwI</span> <span class="o">-</span><span class="mf">0.267314</span>   <span class="mi">84</span>
<span class="mi">3</span>  <span class="n">XX8upUlbDe</span> <span class="o">-</span><span class="mf">0.070919</span>   <span class="mi">96</span>
<span class="mi">4</span>  <span class="n">sJdk6chNnx</span> <span class="o">-</span><span class="mf">0.271030</span>   <span class="mi">60</span>
<span class="mi">5</span>  <span class="n">NTVYJb1d7D</span> <span class="o">-</span><span class="mf">1.236107</span>   <span class="mi">14</span>
<span class="mi">6</span>  <span class="mi">3</span><span class="n">pX0MQsLIz</span> <span class="o">-</span><span class="mf">0.737931</span>   <span class="mi">16</span>
<span class="mi">7</span>  <span class="n">IpNIwdTK4P</span> <span class="o">-</span><span class="mf">0.293744</span>   <span class="mi">23</span>
<span class="mi">8</span>  <span class="n">ucIvA79467</span>  <span class="mf">0.070765</span>   <span class="mi">12</span>
<span class="mi">9</span>  <span class="n">JIunzB1CZs</span> <span class="o">-</span><span class="mf">1.125376</span>    <span class="mi">4</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">table</span><span class="o">.</span><span class="n">bar</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span>   <span class="n">count</span>  <span class="n">nulls</span>       <span class="nb">min</span>       <span class="nb">max</span>        <span class="nb">sum</span>      <span class="n">mean</span>  <span class="n">approx_nunique</span>
<span class="mi">0</span>    <span class="mi">100</span>      <span class="mi">0</span> <span class="o">-</span><span class="mf">1.236107</span>  <span class="mf">1.019943</span> <span class="o">-</span><span class="mf">34.094578</span> <span class="o">-</span><span class="mf">0.340946</span>              <span class="mi">10</span>
</pre></div>
</div>
<p>For functions like <code class="docutils literal"><span class="pre">parquet_file</span></code> and <code class="docutils literal"><span class="pre">delimited_file</span></code>, an HDFS
directory must be passed (we&#8217;ll add support for S3 and other filesystems
later) and the directory must contain files all having the same schema.</p>
<p>If you have Avro data, you can query it too if you have the full avro
schema:</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">avro_schema</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;fields&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;int&quot;</span><span class="p">,</span> <span class="s2">&quot;null&quot;</span><span class="p">],</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;R_REGIONKEY&quot;</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;null&quot;</span><span class="p">],</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;R_NAME&quot;</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;null&quot;</span><span class="p">],</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;R_COMMENT&quot;</span><span class="p">}],</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;record&quot;</span><span class="p">,</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;a&quot;</span>
<span class="p">}</span>

<span class="n">table</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">avro_file</span><span class="p">(</span><span class="s1">&#39;/__ibis/ibis-testing-data/avro/tpch.region&#39;</span><span class="p">,</span> <span class="n">avro_schema</span><span class="p">)</span>
<span class="n">table</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Empty</span> <span class="n">DataFrame</span>
<span class="n">Columns</span><span class="p">:</span> <span class="p">[</span><span class="n">r_regionkey</span><span class="p">,</span> <span class="n">r_name</span><span class="p">,</span> <span class="n">r_comment</span><span class="p">]</span>
<span class="n">Index</span><span class="p">:</span> <span class="p">[]</span>
</pre></div>
</div>
</div>
<div class="section" id="other-helper-functions-for-interacting-with-the-database">
<h1>Other helper functions for interacting with the database<a class="headerlink" href="#other-helper-functions-for-interacting-with-the-database" title="Permalink to this headline">¶</a></h1>
<p>We&#8217;re adding a growing list of useful utility functions for interacting
with an Impala cluster on the client object. The idea is that you should
be able to do any database-admin-type work with Ibis and not have to
switch over to the Impala SQL shell. Any ways we can make this more
pleasant, please let us know.</p>
<p>Here&#8217;s some of the features, which we&#8217;ll give examples for:</p>
<ul class="simple">
<li>Listing and searching for available databases and tables</li>
<li>Creating and dropping databases</li>
<li>Getting table schemas</li>
</ul>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">con</span><span class="o">.</span><span class="n">list_databases</span><span class="p">(</span><span class="n">like</span><span class="o">=</span><span class="s1">&#39;ibis*&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;ibis_testing&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">con</span><span class="o">.</span><span class="n">list_tables</span><span class="p">(</span><span class="n">database</span><span class="o">=</span><span class="s1">&#39;ibis_testing&#39;</span><span class="p">,</span> <span class="n">like</span><span class="o">=</span><span class="s1">&#39;tpch*&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;tpch_ctas_cancel&#39;</span><span class="p">,</span>
 <span class="s1">&#39;tpch_customer&#39;</span><span class="p">,</span>
 <span class="s1">&#39;tpch_lineitem&#39;</span><span class="p">,</span>
 <span class="s1">&#39;tpch_nation&#39;</span><span class="p">,</span>
 <span class="s1">&#39;tpch_orders&#39;</span><span class="p">,</span>
 <span class="s1">&#39;tpch_part&#39;</span><span class="p">,</span>
 <span class="s1">&#39;tpch_partsupp&#39;</span><span class="p">,</span>
 <span class="s1">&#39;tpch_region&#39;</span><span class="p">,</span>
 <span class="s1">&#39;tpch_region_avro&#39;</span><span class="p">,</span>
 <span class="s1">&#39;tpch_supplier&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">schema</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">get_schema</span><span class="p">(</span><span class="s1">&#39;functional_alltypes&#39;</span><span class="p">)</span>
<span class="n">schema</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">ibis</span><span class="o">.</span><span class="n">Schema</span> <span class="p">{</span>
  <span class="nb">id</span>               <span class="n">int32</span>
  <span class="n">bool_col</span>         <span class="n">boolean</span>
  <span class="n">tinyint_col</span>      <span class="n">int8</span>
  <span class="n">smallint_col</span>     <span class="n">int16</span>
  <span class="n">int_col</span>          <span class="n">int32</span>
  <span class="n">bigint_col</span>       <span class="n">int64</span>
  <span class="n">float_col</span>        <span class="nb">float</span>
  <span class="n">double_col</span>       <span class="n">double</span>
  <span class="n">date_string_col</span>  <span class="n">string</span>
  <span class="n">string_col</span>       <span class="n">string</span>
  <span class="n">timestamp_col</span>    <span class="n">timestamp</span>
  <span class="n">year</span>             <span class="n">int32</span>
  <span class="n">month</span>            <span class="n">int32</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Databases can be created, too, and you can set the storage path in HDFS
you want for the data files</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">db</span> <span class="o">=</span> <span class="s1">&#39;ibis_testing2&#39;</span>
<span class="n">con</span><span class="o">.</span><span class="n">create_database</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s1">&#39;/__ibis/my-test-database&#39;</span><span class="p">)</span>
<span class="n">con</span><span class="o">.</span><span class="n">create_table</span><span class="p">(</span><span class="s1">&#39;example_table&#39;</span><span class="p">,</span> <span class="n">con</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="s1">&#39;functional_alltypes&#39;</span><span class="p">),</span>
                 <span class="n">database</span><span class="o">=</span><span class="n">db</span><span class="p">)</span>
</pre></div>
</div>
<p>Hopefully, there will be data files in the indicated spot in HDFS:</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">hdfs</span><span class="o">.</span><span class="n">ls</span><span class="p">(</span><span class="s1">&#39;/__ibis/my-test-database&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">u&#39;example_table&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>To drop a database, including all tables in it, you can use
<code class="docutils literal"><span class="pre">drop_database</span></code> with <code class="docutils literal"><span class="pre">force=True</span></code>:</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">con</span><span class="o">.</span><span class="n">drop_database</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="dealing-with-partitioned-tables-in-impala">
<h1>Dealing with Partitioned tables in Impala<a class="headerlink" href="#dealing-with-partitioned-tables-in-impala" title="Permalink to this headline">¶</a></h1>
<p><strong>Placeholder:</strong> This is not yet implemented. If you have use cases,
please let us know.</p>
</div>
<div class="section" id="faster-queries-on-small-data-in-impala">
<h1>Faster queries on small data in Impala<a class="headerlink" href="#faster-queries-on-small-data-in-impala" title="Permalink to this headline">¶</a></h1>
<p>Since Impala internally uses LLVM to compile parts of queries (aka
&#8220;codegen&#8221;) to make them faster on large data sets there is a certain
amount of overhead with running many kinds of queries, even on small
datasets. You can disable LLVM code generation when using Ibis, which
may significantly speed up queries on smaller datasets:</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numpy.random</span> <span class="k">import</span> <span class="n">rand</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">con</span><span class="o">.</span><span class="n">disable_codegen</span><span class="p">()</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="s1">&#39;ibis_testing.functional_alltypes&#39;</span><span class="p">)</span>

<span class="o">%</span><span class="n">timeit</span> <span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">double_col</span> <span class="o">+</span> <span class="n">rand</span><span class="p">())</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mi">10</span> <span class="n">loops</span><span class="p">,</span> <span class="n">best</span> <span class="n">of</span> <span class="mi">3</span><span class="p">:</span> <span class="mf">47.2</span> <span class="n">ms</span> <span class="n">per</span> <span class="n">loop</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="c1"># Turn codegen back on</span>
<span class="n">con</span><span class="o">.</span><span class="n">disable_codegen</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">timeit</span> <span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">double_col</span> <span class="o">+</span> <span class="n">rand</span><span class="p">())</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mi">1</span> <span class="n">loop</span><span class="p">,</span> <span class="n">best</span> <span class="n">of</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">466</span> <span class="n">ms</span> <span class="n">per</span> <span class="n">loop</span>
</pre></div>
</div>
<p>It&#8217;s important to remember that codegen is a fixed overhead and will
significantly speed up queries on big data</p>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="5.html" class="btn btn-neutral float-right" title="“Top-K” Filtering" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="3.html" class="btn btn-neutral" title="Type casting" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Cloudera, Inc..

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'v0.7.1+17.g3bc20c0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  
 
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-65303298-2', 'auto');
  ga('send', 'pageview');

</script>


</body>
</html>