

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Basics: Aggregation, filtering, limits &mdash; Ibis 0.3.0 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Ibis 0.3.0 documentation" href="../index.html"/>
        <link rel="up" title="Tutorial" href="../tutorial.html"/>
        <link rel="next" title="Projections: adding/selecting columns" href="2.html"/>
        <link rel="prev" title="Intro and Setup" href="0.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="../index.html" class="fa fa-home"> Ibis</a>
        
        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting-started.html">Installation and Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../getting-started.html#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started.html#creating-a-client">Creating a client</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started.html#learning-resources">Learning resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started.html#using-ibis-with-the-cloudera-quickstart-vm">Using Ibis with the Cloudera Quickstart VM</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../configuration.html">Configuring Ibis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../configuration.html#ibis-global-configuration">Ibis global configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration.html#working-with-secure-clusters-kerberos">Working with secure clusters (Kerberos)</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../tutorial.html">Tutorial</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="0.html">Intro and Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="0.html#getting-started">Getting started</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">Basics: Aggregation, filtering, limits</a></li>
<li class="toctree-l2"><a class="reference internal" href="#accessing-an-impala-table">Accessing an Impala table</a></li>
<li class="toctree-l2"><a class="reference internal" href="#column-selection-and-basic-expressions">Column selection and basic expressions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#interactive-mode">Interactive mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="#verbose-mode-and-logging">Verbose mode and logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="#aggregation-basics">Aggregation basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="#filtering">Filtering</a></li>
<li class="toctree-l2"><a class="reference internal" href="#limits">Limits</a></li>
<li class="toctree-l2"><a class="reference internal" href="2.html">Projections: adding/selecting columns</a></li>
<li class="toctree-l2"><a class="reference internal" href="2.html#joins">Joins</a></li>
<li class="toctree-l2"><a class="reference internal" href="2.html#joins-are-declarations-of-intent">Joins are declarations of intent</a></li>
<li class="toctree-l2"><a class="reference internal" href="2.html#explicit-join-materialization">Explicit join materialization</a></li>
<li class="toctree-l2"><a class="reference internal" href="2.html#writing-down-join-keys">Writing down join keys</a></li>
<li class="toctree-l2"><a class="reference internal" href="2.html#join-referential-nuances">Join referential nuances</a></li>
<li class="toctree-l2"><a class="reference internal" href="2.html#aggregating-joined-table-with-metrics-involving-more-than-one-base-reference">Aggregating joined table with metrics involving more than one base reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="2.html#sorting">Sorting</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.html">Type casting</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.html#case-if-then-else-expressions">Case / if-then-else expressions</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.html#set-membership">Set membership</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.html#null-ness">Null-ness</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.html#distinct-based-operations">Distinct-based operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.html#string-operations">String operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.html#timestamp-operations">Timestamp operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="4.html">Creating new Impala tables from Ibis expressions</a></li>
<li class="toctree-l2"><a class="reference internal" href="4.html#inserting-data-into-existing-impala-tables">Inserting data into existing Impala tables</a></li>
<li class="toctree-l2"><a class="reference internal" href="4.html#uploading-downloading-data-from-hdfs">Uploading / downloading data from HDFS</a></li>
<li class="toctree-l2"><a class="reference internal" href="4.html#queries-on-parquet-avro-and-delimited-files-in-hdfs">Queries on Parquet, Avro, and Delimited files in HDFS</a></li>
<li class="toctree-l2"><a class="reference internal" href="4.html#other-helper-functions-for-interacting-with-the-database">Other helper functions for interacting with the database</a></li>
<li class="toctree-l2"><a class="reference internal" href="4.html#dealing-with-partitioned-tables-in-impala">Dealing with Partitioned tables in Impala</a></li>
<li class="toctree-l2"><a class="reference internal" href="4.html#faster-queries-on-small-data-in-impala">Faster queries on small data in Impala</a></li>
<li class="toctree-l2"><a class="reference internal" href="5.html">&#8220;Top-K&#8221; Filtering</a></li>
<li class="toctree-l2"><a class="reference internal" href="5.html#self-joins">Self joins</a></li>
<li class="toctree-l2"><a class="reference internal" href="6.html">More filtering mojo for your analytics</a></li>
<li class="toctree-l2"><a class="reference internal" href="6.html#using-scalar-aggregates-in-filters">Using scalar aggregates in filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="6.html#conditional-aggregates">Conditional aggregates</a></li>
<li class="toctree-l2"><a class="reference internal" href="6.html#existence-filters">&#8220;Existence&#8221; filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="7.html">Frequency tables</a></li>
<li class="toctree-l2"><a class="reference internal" href="7.html#binning-and-histograms">Binning and histograms</a></li>
<li class="toctree-l2"><a class="reference internal" href="7.html#filtering-in-aggregations">Filtering in aggregations</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../api.html#creating-connections">Creating connections</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#impala-client">Impala client</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#hdfs">HDFS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#top-level-expression-apis">Top-level expression APIs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#api-table">Table methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#generic-value-methods">Generic value methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#general-numeric-methods">General numeric methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#integer-methods">Integer methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#string-methods">String methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#timestamp-methods">Timestamp methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#boolean-methods">Boolean methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#category-methods">Category methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#decimal-methods">Decimal methods</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../sql.html">Ibis for SQL Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../impala.html">Ibis for Impala users</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../impala.html#table-metadata">Table metadata</a></li>
<li class="toctree-l2"><a class="reference internal" href="../impala.html#table-partition-management">Table partition management</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../release.html">Release Notes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../release.html#july-20-2015">0.3.0 (July 20, 2015)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#june-16-2015">0.2.0 (June 16, 2015)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#march-26-2015">0.1.0 (March 26, 2015)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../developer.html">Developing and Contributing to Ibis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../developer.html#test-environment-setup">Test environment setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developer.html#contribution-ideas">Contribution Ideas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developer.html#contributor-license-agreements">Contributor License Agreements</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../type-system.html">Ibis design internals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../legal.html">Legal</a></li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">Ibis</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../tutorial.html">Tutorial</a> &raquo;</li>
      
    <li>Basics: Aggregation, filtering, limits</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="../_sources/generated-notebooks/1.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="basics-aggregation-filtering-limits">
<h1>Basics: Aggregation, filtering, limits<a class="headerlink" href="#basics-aggregation-filtering-limits" title="Permalink to this headline">¶</a></h1>
<p>Now that you have ibis installed and connecting to your Impala, let&#8217;s
get our feet wet.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">ibis</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">hdfs_port</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;IBIS_WEBHDFS_PORT&#39;</span><span class="p">,</span> <span class="mi">50070</span><span class="p">)</span>

<span class="n">ic</span> <span class="o">=</span> <span class="n">ibis</span><span class="o">.</span><span class="n">impala_connect</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s">&#39;quickstart.cloudera&#39;</span><span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="s">&#39;ibis_testing&#39;</span><span class="p">)</span>
<span class="n">hdfs</span> <span class="o">=</span> <span class="n">ibis</span><span class="o">.</span><span class="n">hdfs_connect</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s">&#39;quickstart.cloudera&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="n">hdfs_port</span><span class="p">)</span>
<span class="n">con</span> <span class="o">=</span> <span class="n">ibis</span><span class="o">.</span><span class="n">make_client</span><span class="p">(</span><span class="n">ic</span><span class="p">,</span> <span class="n">hdfs_client</span><span class="o">=</span><span class="n">hdfs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="accessing-an-impala-table">
<h1>Accessing an Impala table<a class="headerlink" href="#accessing-an-impala-table" title="Permalink to this headline">¶</a></h1>
<p>The optional <code class="docutils literal"><span class="pre">database</span></code> paramter allows to fully qualify the table.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">table</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="s">&#39;functional_alltypes&#39;</span><span class="p">)</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="s">&#39;functional_alltypes&#39;</span><span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="s">&#39;ibis_testing&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="column-selection-and-basic-expressions">
<h1>Column selection and basic expressions<a class="headerlink" href="#column-selection-and-basic-expressions" title="Permalink to this headline">¶</a></h1>
<p>Selecting columns from a table works just like pandas</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">col</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">double_col</span>

<span class="c"># alternately</span>
<span class="n">col2</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="s">&#39;bigint_col&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>Table columns are equipped with a variety of math operations and other
methods to assist in writing your analytics. For example:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">expr</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">log2</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span>
</pre></div>
</div>
<p>Some operations transform arrays to arrays, while others aggregate, like
<code class="docutils literal"><span class="pre">sum</span></code> and <code class="docutils literal"><span class="pre">mean</span></code>:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">expr2</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
<p>The methods that are available on columns depend on the time of the
column. For example, you won&#8217;t see the <code class="docutils literal"><span class="pre">substr</span></code> or <code class="docutils literal"><span class="pre">upper</span></code> methods
for strings on numeric columns:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">substr_expr</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">string_col</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="o">.</span><span class="n">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>Notice that printing the expressions to the console does not actually do
anything, and shows a graphical representation of the expression you&#8217;ve
built.</p>
<p><strong>Note: don&#8217;t worry too much about the details of the expression tree
that&#8217;s outputted, it&#8217;s very likely to change over time</strong></p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">expr2</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>ref_0
DatabaseTable[table]
  name: ibis_testing.`functional_alltypes`
  schema:
    id : int32
    bool_col : boolean
    tinyint_col : int8
    smallint_col : int16
    int_col : int32
    bigint_col : int64
    float_col : float
    double_col : double
    date_string_col : string
    string_col : string
    timestamp_col : timestamp
    year : int32
    month : int32

sum = Sum[double]
  Subtract[array(double)]
    Log2[array(double)]
      double_col = Column[double] &#39;double_col&#39; from table ref_0
    Literal[int8]
      1
  None
</pre></div>
</div>
<p>We can also execute an expression by calling <code class="docutils literal"><span class="pre">execute</span></code> on the Impala
connection object</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">con</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">col</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="mf">331785.0</span>
</pre></div>
</div>
<p>There&#8217;s a shortcut to make this a little more convenient in interactive
use</p>
</div>
<div class="section" id="interactive-mode">
<h1>Interactive mode<a class="headerlink" href="#interactive-mode" title="Permalink to this headline">¶</a></h1>
<p>Many Ibis expressions can be immediately executed against the database,
and it may improve your productivity to have the executed for you
whenever you try to print the expression in the console / IPython
notebook.</p>
<p>To do this, we have an <em>interactive</em> mode available, which can be turned
on/off like so:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">ibis</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">interactive</span> <span class="o">=</span> <span class="bp">True</span>
</pre></div>
</div>
<p>Now, any expressions you write will be executed right away</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">table</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<pre class="literal-block">
        id bool_col  tinyint_col  smallint_col  int_col  bigint_col  0     4550     True            0             0        0           0
1     4551    False            1             1        1          10
2     4552     True            2             2        2          20
3     4553    False            3             3        3          30
4     4554     True            4             4        4          40
5     4555    False            5             5        5          50
6     4556     True            6             6        6          60
7     4557    False            7             7        7          70
8     4558     True            8             8        8          80
9     4559    False            9             9        9          90
10    4560     True            0             0        0           0
11    4561    False            1             1        1          10
12    4562     True            2             2        2          20
13    4563    False            3             3        3          30
14    4564     True            4             4        4          40
15    4565    False            5             5        5          50
16    4566     True            6             6        6          60
17    4567    False            7             7        7          70
18    4568     True            8             8        8          80
19    4569    False            9             9        9          90
20    4570     True            0             0        0           0
21    4571    False            1             1        1          10
22    4572     True            2             2        2          20
23    4573    False            3             3        3          30
24    4574     True            4             4        4          40
25    4575    False            5             5        5          50
26    4576     True            6             6        6          60
27    4577    False            7             7        7          70
28    4578     True            8             8        8          80
29    4579    False            9             9        9          90
...    ...      ...          ...           ...      ...         ...
7270  3620     True            0             0        0           0
7271  3621    False            1             1        1          10
7272  3622     True            2             2        2          20
7273  3623    False            3             3        3          30
7274  3624     True            4             4        4          40
7275  3625    False            5             5        5          50
7276  3626     True            6             6        6          60
7277  3627    False            7             7        7          70
7278  3628     True            8             8        8          80
7279  3629    False            9             9        9          90
7280  3630     True            0             0        0           0
7281  3631    False            1             1        1          10
7282  3632     True            2             2        2          20
7283  3633    False            3             3        3          30
7284  3634     True            4             4        4          40
7285  3635    False            5             5        5          50
7286  3636     True            6             6        6          60
7287  3637    False            7             7        7          70
7288  3638     True            8             8        8          80
7289  3639    False            9             9        9          90
7290  3640     True            0             0        0           0
7291  3641    False            1             1        1          10
7292  3642     True            2             2        2          20
7293  3643    False            3             3        3          30
7294  3644     True            4             4        4          40
7295  3645    False            5             5        5          50
7296  3646     True            6             6        6          60
7297  3647    False            7             7        7          70
7298  3648     True            8             8        8          80
7299  3649    False            9             9        9          90

      float_col  double_col date_string_col string_col  0           0.0         0.0        04/01/10          0
1           1.1        10.1        04/01/10          1
2           2.2        20.2        04/01/10          2
3           3.3        30.3        04/01/10          3
4           4.4        40.4        04/01/10          4
5           5.5        50.5        04/01/10          5
6           6.6        60.6        04/01/10          6
7           7.7        70.7        04/01/10          7
8           8.8        80.8        04/01/10          8
9           9.9        90.9        04/01/10          9
10          0.0         0.0        04/02/10          0
11          1.1        10.1        04/02/10          1
12          2.2        20.2        04/02/10          2
13          3.3        30.3        04/02/10          3
14          4.4        40.4        04/02/10          4
15          5.5        50.5        04/02/10          5
16          6.6        60.6        04/02/10          6
17          7.7        70.7        04/02/10          7
18          8.8        80.8        04/02/10          8
19          9.9        90.9        04/02/10          9
20          0.0         0.0        04/03/10          0
21          1.1        10.1        04/03/10          1
22          2.2        20.2        04/03/10          2
23          3.3        30.3        04/03/10          3
24          4.4        40.4        04/03/10          4
25          5.5        50.5        04/03/10          5
26          6.6        60.6        04/03/10          6
27          7.7        70.7        04/03/10          7
28          8.8        80.8        04/03/10          8
29          9.9        90.9        04/03/10          9
...         ...         ...             ...        ...
7270        0.0         0.0        12/29/09          0
7271        1.1        10.1        12/29/09          1
7272        2.2        20.2        12/29/09          2
7273        3.3        30.3        12/29/09          3
7274        4.4        40.4        12/29/09          4
7275        5.5        50.5        12/29/09          5
7276        6.6        60.6        12/29/09          6
7277        7.7        70.7        12/29/09          7
7278        8.8        80.8        12/29/09          8
7279        9.9        90.9        12/29/09          9
7280        0.0         0.0        12/30/09          0
7281        1.1        10.1        12/30/09          1
7282        2.2        20.2        12/30/09          2
7283        3.3        30.3        12/30/09          3
7284        4.4        40.4        12/30/09          4
7285        5.5        50.5        12/30/09          5
7286        6.6        60.6        12/30/09          6
7287        7.7        70.7        12/30/09          7
7288        8.8        80.8        12/30/09          8
7289        9.9        90.9        12/30/09          9
7290        0.0         0.0        12/31/09          0
7291        1.1        10.1        12/31/09          1
7292        2.2        20.2        12/31/09          2
7293        3.3        30.3        12/31/09          3
7294        4.4        40.4        12/31/09          4
7295        5.5        50.5        12/31/09          5
7296        6.6        60.6        12/31/09          6
7297        7.7        70.7        12/31/09          7
7298        8.8        80.8        12/31/09          8
7299        9.9        90.9        12/31/09          9

               timestamp_col  year  month
0    2010-04-01 00:00:00.000  2010      4
1    2010-04-01 00:01:00.000  2010      4
2    2010-04-01 00:02:00.100  2010      4
3    2010-04-01 00:03:00.300  2010      4
4    2010-04-01 00:04:00.600  2010      4
5    2010-04-01 00:05:00.100  2010      4
6    2010-04-01 00:06:00.150  2010      4
7    2010-04-01 00:07:00.210  2010      4
8    2010-04-01 00:08:00.280  2010      4
9    2010-04-01 00:09:00.360  2010      4
10   2010-04-02 00:10:00.450  2010      4
11   2010-04-02 00:11:00.450  2010      4
12   2010-04-02 00:12:00.460  2010      4
13   2010-04-02 00:13:00.480  2010      4
14   2010-04-02 00:14:00.510  2010      4
15   2010-04-02 00:15:00.550  2010      4
16   2010-04-02 00:16:00.600  2010      4
17   2010-04-02 00:17:00.660  2010      4
18   2010-04-02 00:18:00.730  2010      4
19   2010-04-02 00:19:00.810  2010      4
20   2010-04-03 00:20:00.900  2010      4
21   2010-04-03 00:21:00.900  2010      4
22   2010-04-03 00:22:00.910  2010      4
23   2010-04-03 00:23:00.930  2010      4
24   2010-04-03 00:24:00.960  2010      4
25   2010-04-03 00:25:01.000  2010      4
26   2010-04-03 00:26:01.500  2010      4
27   2010-04-03 00:27:01.110  2010      4
28   2010-04-03 00:28:01.180  2010      4
29   2010-04-03 00:29:01.260  2010      4
...                      ...   ...    ...
7270 2009-12-29 04:40:12.600  2009     12
7271 2009-12-29 04:41:12.600  2009     12
7272 2009-12-29 04:42:12.610  2009     12
7273 2009-12-29 04:43:12.630  2009     12
7274 2009-12-29 04:44:12.660  2009     12
7275 2009-12-29 04:45:12.700  2009     12
7276 2009-12-29 04:46:12.750  2009     12
7277 2009-12-29 04:47:12.810  2009     12
7278 2009-12-29 04:48:12.880  2009     12
7279 2009-12-29 04:49:12.960  2009     12
7280 2009-12-30 04:50:13.500  2009     12
7281 2009-12-30 04:51:13.500  2009     12
7282 2009-12-30 04:52:13.600  2009     12
7283 2009-12-30 04:53:13.800  2009     12
7284 2009-12-30 04:54:13.110  2009     12
7285 2009-12-30 04:55:13.150  2009     12
7286 2009-12-30 04:56:13.200  2009     12
7287 2009-12-30 04:57:13.260  2009     12
7288 2009-12-30 04:58:13.330  2009     12
7289 2009-12-30 04:59:13.410  2009     12
7290 2009-12-31 05:00:13.500  2009     12
7291 2009-12-31 05:01:13.500  2009     12
7292 2009-12-31 05:02:13.510  2009     12
7293 2009-12-31 05:03:13.530  2009     12
7294 2009-12-31 05:04:13.560  2009     12
7295 2009-12-31 05:05:13.600  2009     12
7296 2009-12-31 05:06:13.650  2009     12
7297 2009-12-31 05:07:13.710  2009     12
7298 2009-12-31 05:08:13.780  2009     12
7299 2009-12-31 05:09:13.860  2009     12

[7300 rows x 13 columns]
</pre>
<p>You can select a row range with slicing syntax:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">table</span><span class="o">.</span><span class="n">double_col</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="mf">331785.0</span>
</pre></div>
</div>
<p>Don&#8217;t worry about the syntax here, but expressions resulting in tabular
output will come back as a pandas DataFrame by default:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">metrics</span> <span class="o">=</span> <span class="p">[</span><span class="n">table</span><span class="o">.</span><span class="n">double_col</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="s">&#39;total&#39;</span><span class="p">)]</span>
<span class="n">expr</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="s">&#39;string_col&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="n">metrics</span><span class="p">)</span>
<span class="n">expr</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>  string_col  total
0          6  44238
1          4  29492
2          7  51611
3          1   7373
4          9  66357
5          8  58984
6          3  22119
7          2  14746
8          5  36865
9          0      0
</pre></div>
</div>
</div>
<div class="section" id="verbose-mode-and-logging">
<h1>Verbose mode and logging<a class="headerlink" href="#verbose-mode-and-logging" title="Permalink to this headline">¶</a></h1>
<p>You may want to see or log all the Impala queries that Ibis executes
under the hood. To do that, use the <code class="docutils literal"><span class="pre">options.verbose</span></code> option:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">ibis</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="bp">True</span>

<span class="n">metrics</span> <span class="o">=</span> <span class="p">[</span><span class="n">table</span><span class="o">.</span><span class="n">double_col</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="s">&#39;total&#39;</span><span class="p">)]</span>
<span class="n">expr</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="s">&#39;string_col&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="n">metrics</span><span class="p">)</span>
<span class="n">expr</span>
</pre></div>
</div>
<pre class="literal-block">
SELECT <cite>string_col</cite>, sum(<cite>double_col</cite>) AS <cite>total</cite>
FROM ibis_testing.`functional_alltypes`
GROUP BY 1
LIMIT 10000
</pre>
<div class="highlight-python"><div class="highlight"><pre>  string_col  total
0          6  44238
1          4  29492
2          1   7373
3          7  51611
4          8  58984
5          9  66357
6          2  14746
7          3  22119
8          5  36865
9          0      0
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">queries</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">def</span> <span class="nf">logger</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">queries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">ibis</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">verbose_log</span> <span class="o">=</span> <span class="n">logger</span>

<span class="n">expr</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
<span class="n">expr</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>

<span class="n">queries</span>
</pre></div>
</div>
<pre class="literal-block">
['SELECT <cite>string_col</cite>, sum(<cite>double_col</cite>) AS <cite>total</cite>nFROM ibis_testing.`functional_alltypes`nGROUP BY 1nLIMIT 10000',
 'SELECT <cite>string_col</cite>, sum(<cite>double_col</cite>) AS <cite>total</cite>nFROM ibis_testing.`functional_alltypes`nGROUP BY 1nLIMIT 10000']
</pre>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
<span class="n">ibis</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">verbose_log</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="k">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">ibis</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="bp">False</span>
</pre></div>
</div>
</div>
<div class="section" id="aggregation-basics">
<h1>Aggregation basics<a class="headerlink" href="#aggregation-basics" title="Permalink to this headline">¶</a></h1>
<p>One of the essential table API functions is <code class="docutils literal"><span class="pre">aggregate</span></code>. Aggregation
involves the following</p>
<ul class="simple">
<li>One or more <em>named</em> aggregate expressions, or <em>reductions</em></li>
<li>Zero or more grouping expressions or column names</li>
</ul>
<p>This ends up working very similarly to pandas&#8217;s <strong>groupby</strong> mechanism.</p>
<p>Let&#8217;s start with a simple reduction:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">metric</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">double_col</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
<p>As you saw above, you can execute this immediately and obtain a value:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">metric</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="mf">331785.0</span>
</pre></div>
</div>
<p>The reduced column can be more complex; for example, you could count the
number of null values in a column like so:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">table</span><span class="o">.</span><span class="n">double_col</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="mi">0</span>
</pre></div>
</div>
<p>To aggregate a table, potentially with grouping keys, we have to give
the reduction a name and call <code class="docutils literal"><span class="pre">aggregate</span></code></p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">metric</span> <span class="o">=</span> <span class="n">metric</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="s">&#39;double_total&#39;</span><span class="p">)</span>
<span class="n">expr</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">aggregate</span><span class="p">([</span><span class="n">metric</span><span class="p">])</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
<span class="n">result</span>
</pre></div>
</div>
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>double_total</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>331785</td>
    </tr>
  </tbody>
</table>
</div><p>The result here is actually a pandas DataFrame with 1 row and just the
one column. We can add another metric and add a grouping key</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">metric2</span> <span class="o">=</span> <span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">bigint_col</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">log10</span><span class="p">()</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="s">&#39;some_metric&#39;</span><span class="p">)</span>

<span class="n">expr</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">aggregate</span><span class="p">([</span><span class="n">metric</span><span class="p">,</span> <span class="n">metric2</span><span class="p">],</span> <span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;string_col&#39;</span><span class="p">])</span>
<span class="n">expr</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>  string_col  double_total  some_metric
0          6         44238     1.785330
1          1          7373     1.041393
2          4         29492     1.612784
3          8         58984     1.908485
4          7         51611     1.851258
5          2         14746     1.322219
6          9         66357     1.959041
7          3         22119     1.491362
8          5         36865     1.707570
9          0             0     0.000000
</pre></div>
</div>
<p>We provide a convenience <code class="docutils literal"><span class="pre">group_by</span></code>, a la pandas, to make this a
little more composable:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">expr</span> <span class="o">=</span> <span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="s">&#39;string_col&#39;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">aggregate</span><span class="p">([</span><span class="n">metric</span><span class="p">,</span> <span class="n">metric2</span><span class="p">]))</span>
<span class="n">expr</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>  string_col  double_total  some_metric
0          6         44238     1.785330
1          1          7373     1.041393
2          4         29492     1.612784
3          7         51611     1.851258
4          8         58984     1.908485
5          2         14746     1.322219
6          5         36865     1.707570
7          9         66357     1.959041
8          0             0     0.000000
9          3         22119     1.491362
</pre></div>
</div>
<p>You can also group by named column expressions</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">table</span><span class="o">.</span><span class="n">timestamp_col</span><span class="o">.</span><span class="n">hour</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="s">&#39;hour&#39;</span><span class="p">),</span> <span class="s">&#39;string_col&#39;</span><span class="p">]</span>

<span class="n">expr</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span><span class="o">.</span><span class="n">aggregate</span><span class="p">([</span><span class="n">metric</span><span class="p">])</span>

<span class="c"># Top 10 by double_total, more on this later</span>
<span class="n">expr</span><span class="o">.</span><span class="n">sort_by</span><span class="p">([(</span><span class="s">&#39;double_total&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">)])</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>    hour string_col  double_total
0      1          9       13544.1
1      2          9       13180.5
2      0          9       13089.6
3      3          9       13089.6
4      4          9       12271.5
5      1          8       12039.2
6      2          8       11716.0
7      0          8       11635.2
8      3          8       11635.2
9      4          8       10908.0
10     1          7       10534.3
11     2          7       10251.5
12     3          7       10180.8
13     0          7       10180.8
14     4          7        9544.5
15     1          6        9029.4
16     2          6        8787.0
17     0          6        8726.4
18     3          6        8726.4
19     4          6        8181.0
20     1          5        7524.5
21     2          5        7322.5
22     3          5        7272.0
23     0          5        7272.0
24     4          5        6817.5
25     1          4        6019.6
26     2          4        5858.0
27     0          4        5817.6
28     3          4        5817.6
29     4          4        5454.0
30     1          3        4514.7
31     2          3        4393.5
32     0          3        4363.2
33     3          3        4363.2
34     4          3        4090.5
35     1          2        3009.8
36     2          2        2929.0
37     3          2        2908.8
38     0          2        2908.8
39     4          2        2727.0
40     1          1        1504.9
41     2          1        1464.5
42     0          1        1454.4
43     3          1        1454.4
44     4          1        1363.5
45     5          9        1181.7
46     5          8        1050.4
47     5          7         919.1
48     5          6         787.8
49     5          5         656.5
50     5          4         525.2
51     5          3         393.9
52     5          2         262.6
53     5          1         131.3
54     5          0           0.0
55     2          0           0.0
56     3          0           0.0
57     4          0           0.0
58     1          0           0.0
59     0          0           0.0
</pre></div>
</div>
<p>In most cases, an aggregation by itself can be evaluated:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">table</span><span class="o">.</span><span class="n">double_col</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="mf">45.450000000000003</span>
</pre></div>
</div>
<p>This can also be done in simple cases along with <code class="docutils literal"><span class="pre">group_by</span></code>:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">table</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="s">&#39;string_col&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">double_col</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>  string_col  mean(double_col)
0          6              60.6
1          4              40.4
2          7              70.7
3          1              10.1
4          8              80.8
5          2              20.2
6          5              50.5
7          0               0.0
8          9              90.9
9          3              30.3
</pre></div>
</div>
<p>Many reduction functions have a default expression name, unlike many
other Ibis expressions (for now!), to make some common analyses easier:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">d</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">double_col</span>

<span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="s">&#39;string_col&#39;</span><span class="p">)</span>
 <span class="o">.</span><span class="n">aggregate</span><span class="p">([</span><span class="n">d</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="n">d</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">d</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">d</span><span class="o">.</span><span class="n">max</span><span class="p">()]))</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>  string_col    sum  mean   min   max
0          6  44238  60.6  60.6  60.6
1          4  29492  40.4  40.4  40.4
2          1   7373  10.1  10.1  10.1
3          7  51611  70.7  70.7  70.7
4          8  58984  80.8  80.8  80.8
5          2  14746  20.2  20.2  20.2
6          9  66357  90.9  90.9  90.9
7          3  22119  30.3  30.3  30.3
8          5  36865  50.5  50.5  50.5
9          0      0   0.0   0.0   0.0
</pre></div>
</div>
<p>Of course, for this <em>particular</em> case you can always use <code class="docutils literal"><span class="pre">summary</span></code></p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">table</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="s">&#39;string_col&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">double_col</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>  string_col  count  nulls   min   max    sum  mean  approx_nunique
0          6    730      0  60.6  60.6  44238  60.6               1
1          4    730      0  40.4  40.4  29492  40.4               1
2          7    730      0  70.7  70.7  51611  70.7               1
3          1    730      0  10.1  10.1   7373  10.1               1
4          8    730      0  80.8  80.8  58984  80.8               1
5          2    730      0  20.2  20.2  14746  20.2               1
6          5    730      0  50.5  50.5  36865  50.5               1
7          0    730      0   0.0   0.0      0   0.0               1
8          9    730      0  90.9  90.9  66357  90.9               1
9          3    730      0  30.3  30.3  22119  30.3               1
</pre></div>
</div>
</div>
<div class="section" id="filtering">
<h1>Filtering<a class="headerlink" href="#filtering" title="Permalink to this headline">¶</a></h1>
<p>Filtering tables works similarly to pandas</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">table</span><span class="o">.</span><span class="n">aggregate</span><span class="p">([</span><span class="n">table</span><span class="o">.</span><span class="n">bigint_col</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="s">&#39;bigint_max&#39;</span><span class="p">),</span>
                 <span class="n">table</span><span class="o">.</span><span class="n">bigint_col</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="s">&#39;bigint_min&#39;</span><span class="p">),</span>
                 <span class="n">table</span><span class="o">.</span><span class="n">int_col</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="s">&#39;int_max&#39;</span><span class="p">),</span>
                 <span class="n">table</span><span class="o">.</span><span class="n">int_col</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="s">&#39;int_min&#39;</span><span class="p">)])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>   bigint_max  bigint_min  int_max  int_min
0          90           0        9        0
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">table</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="mi">7300</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">table</span><span class="p">[</span><span class="n">table</span><span class="o">.</span><span class="n">bigint_col</span> <span class="o">&gt;</span> <span class="mi">50</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="mi">2920</span>
</pre></div>
</div>
<p>Filters can be composed using &amp; (and), | (or), and other logical array
operators</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">cond1</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">bigint_col</span> <span class="o">&gt;</span> <span class="mi">50</span>
<span class="n">cond2</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">int_col</span><span class="o">.</span><span class="n">between</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="n">table</span><span class="p">[</span><span class="n">cond1</span> <span class="o">|</span> <span class="n">cond2</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="mi">5840</span>
</pre></div>
</div>
<p>There&#8217;s a <code class="docutils literal"><span class="pre">filter</span></code> function that allows you to pass a list of
conditions (that are all required to hold):</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">table</span><span class="o">.</span><span class="n">filter</span><span class="p">([</span><span class="n">cond1</span><span class="p">,</span> <span class="n">cond2</span><span class="p">])</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="mi">1460</span>
</pre></div>
</div>
<p>Note this is the same as &amp;-ing the boolean conditions yourself:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">table</span><span class="p">[</span><span class="n">cond1</span> <span class="o">&amp;</span> <span class="n">cond2</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="mi">1460</span>
</pre></div>
</div>
</div>
<div class="section" id="limits">
<h1>Limits<a class="headerlink" href="#limits" title="Permalink to this headline">¶</a></h1>
<p>Like in SQL, the <code class="docutils literal"><span class="pre">limit</span></code> function selects the indicated numbers of
rows from the beginning of a table&#8217;s result set</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">table</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<pre class="literal-block">
        id bool_col  tinyint_col  smallint_col  int_col  bigint_col  0     6690     True            0             0        0           0
1     6691    False            1             1        1          10
2     6692     True            2             2        2          20
3     6693    False            3             3        3          30
4     6694     True            4             4        4          40
5     6695    False            5             5        5          50
6     6696     True            6             6        6          60
7     6697    False            7             7        7          70
8     6698     True            8             8        8          80
9     6699    False            9             9        9          90
10    6700     True            0             0        0           0
11    6701    False            1             1        1          10
12    6702     True            2             2        2          20
13    6703    False            3             3        3          30
14    6704     True            4             4        4          40
15    6705    False            5             5        5          50
16    6706     True            6             6        6          60
17    6707    False            7             7        7          70
18    6708     True            8             8        8          80
19    6709    False            9             9        9          90
20    6710     True            0             0        0           0
21    6711    False            1             1        1          10
22    6712     True            2             2        2          20
23    6713    False            3             3        3          30
24    6714     True            4             4        4          40
25    6715    False            5             5        5          50
26    6716     True            6             6        6          60
27    6717    False            7             7        7          70
28    6718     True            8             8        8          80
29    6719    False            9             9        9          90
...    ...      ...          ...           ...      ...         ...
7270  3930     True            0             0        0           0
7271  3931    False            1             1        1          10
7272  3932     True            2             2        2          20
7273  3933    False            3             3        3          30
7274  3934     True            4             4        4          40
7275  3935    False            5             5        5          50
7276  3936     True            6             6        6          60
7277  3937    False            7             7        7          70
7278  3938     True            8             8        8          80
7279  3939    False            9             9        9          90
7280  3940     True            0             0        0           0
7281  3941    False            1             1        1          10
7282  3942     True            2             2        2          20
7283  3943    False            3             3        3          30
7284  3944     True            4             4        4          40
7285  3945    False            5             5        5          50
7286  3946     True            6             6        6          60
7287  3947    False            7             7        7          70
7288  3948     True            8             8        8          80
7289  3949    False            9             9        9          90
7290  3950     True            0             0        0           0
7291  3951    False            1             1        1          10
7292  3952     True            2             2        2          20
7293  3953    False            3             3        3          30
7294  3954     True            4             4        4          40
7295  3955    False            5             5        5          50
7296  3956     True            6             6        6          60
7297  3957    False            7             7        7          70
7298  3958     True            8             8        8          80
7299  3959    False            9             9        9          90

      float_col  double_col date_string_col string_col  0           0.0         0.0        11/01/10          0
1           1.1        10.1        11/01/10          1
2           2.2        20.2        11/01/10          2
3           3.3        30.3        11/01/10          3
4           4.4        40.4        11/01/10          4
5           5.5        50.5        11/01/10          5
6           6.6        60.6        11/01/10          6
7           7.7        70.7        11/01/10          7
8           8.8        80.8        11/01/10          8
9           9.9        90.9        11/01/10          9
10          0.0         0.0        11/02/10          0
11          1.1        10.1        11/02/10          1
12          2.2        20.2        11/02/10          2
13          3.3        30.3        11/02/10          3
14          4.4        40.4        11/02/10          4
15          5.5        50.5        11/02/10          5
16          6.6        60.6        11/02/10          6
17          7.7        70.7        11/02/10          7
18          8.8        80.8        11/02/10          8
19          9.9        90.9        11/02/10          9
20          0.0         0.0        11/03/10          0
21          1.1        10.1        11/03/10          1
22          2.2        20.2        11/03/10          2
23          3.3        30.3        11/03/10          3
24          4.4        40.4        11/03/10          4
25          5.5        50.5        11/03/10          5
26          6.6        60.6        11/03/10          6
27          7.7        70.7        11/03/10          7
28          8.8        80.8        11/03/10          8
29          9.9        90.9        11/03/10          9
...         ...         ...             ...        ...
7270        0.0         0.0        01/29/10          0
7271        1.1        10.1        01/29/10          1
7272        2.2        20.2        01/29/10          2
7273        3.3        30.3        01/29/10          3
7274        4.4        40.4        01/29/10          4
7275        5.5        50.5        01/29/10          5
7276        6.6        60.6        01/29/10          6
7277        7.7        70.7        01/29/10          7
7278        8.8        80.8        01/29/10          8
7279        9.9        90.9        01/29/10          9
7280        0.0         0.0        01/30/10          0
7281        1.1        10.1        01/30/10          1
7282        2.2        20.2        01/30/10          2
7283        3.3        30.3        01/30/10          3
7284        4.4        40.4        01/30/10          4
7285        5.5        50.5        01/30/10          5
7286        6.6        60.6        01/30/10          6
7287        7.7        70.7        01/30/10          7
7288        8.8        80.8        01/30/10          8
7289        9.9        90.9        01/30/10          9
7290        0.0         0.0        01/31/10          0
7291        1.1        10.1        01/31/10          1
7292        2.2        20.2        01/31/10          2
7293        3.3        30.3        01/31/10          3
7294        4.4        40.4        01/31/10          4
7295        5.5        50.5        01/31/10          5
7296        6.6        60.6        01/31/10          6
7297        7.7        70.7        01/31/10          7
7298        8.8        80.8        01/31/10          8
7299        9.9        90.9        01/31/10          9

               timestamp_col  year  month
0    2010-11-01 00:00:00.000  2010     11
1    2010-11-01 00:01:00.000  2010     11
2    2010-11-01 00:02:00.100  2010     11
3    2010-11-01 00:03:00.300  2010     11
4    2010-11-01 00:04:00.600  2010     11
5    2010-11-01 00:05:00.100  2010     11
6    2010-11-01 00:06:00.150  2010     11
7    2010-11-01 00:07:00.210  2010     11
8    2010-11-01 00:08:00.280  2010     11
9    2010-11-01 00:09:00.360  2010     11
10   2010-11-02 00:10:00.450  2010     11
11   2010-11-02 00:11:00.450  2010     11
12   2010-11-02 00:12:00.460  2010     11
13   2010-11-02 00:13:00.480  2010     11
14   2010-11-02 00:14:00.510  2010     11
15   2010-11-02 00:15:00.550  2010     11
16   2010-11-02 00:16:00.600  2010     11
17   2010-11-02 00:17:00.660  2010     11
18   2010-11-02 00:18:00.730  2010     11
19   2010-11-02 00:19:00.810  2010     11
20   2010-11-03 00:20:00.900  2010     11
21   2010-11-03 00:21:00.900  2010     11
22   2010-11-03 00:22:00.910  2010     11
23   2010-11-03 00:23:00.930  2010     11
24   2010-11-03 00:24:00.960  2010     11
25   2010-11-03 00:25:01.000  2010     11
26   2010-11-03 00:26:01.500  2010     11
27   2010-11-03 00:27:01.110  2010     11
28   2010-11-03 00:28:01.180  2010     11
29   2010-11-03 00:29:01.260  2010     11
...                      ...   ...    ...
7270 2010-01-29 04:40:12.600  2010      1
7271 2010-01-29 04:41:12.600  2010      1
7272 2010-01-29 04:42:12.610  2010      1
7273 2010-01-29 04:43:12.630  2010      1
7274 2010-01-29 04:44:12.660  2010      1
7275 2010-01-29 04:45:12.700  2010      1
7276 2010-01-29 04:46:12.750  2010      1
7277 2010-01-29 04:47:12.810  2010      1
7278 2010-01-29 04:48:12.880  2010      1
7279 2010-01-29 04:49:12.960  2010      1
7280 2010-01-30 04:50:13.500  2010      1
7281 2010-01-30 04:51:13.500  2010      1
7282 2010-01-30 04:52:13.600  2010      1
7283 2010-01-30 04:53:13.800  2010      1
7284 2010-01-30 04:54:13.110  2010      1
7285 2010-01-30 04:55:13.150  2010      1
7286 2010-01-30 04:56:13.200  2010      1
7287 2010-01-30 04:57:13.260  2010      1
7288 2010-01-30 04:58:13.330  2010      1
7289 2010-01-30 04:59:13.410  2010      1
7290 2010-01-31 05:00:13.500  2010      1
7291 2010-01-31 05:01:13.500  2010      1
7292 2010-01-31 05:02:13.510  2010      1
7293 2010-01-31 05:03:13.530  2010      1
7294 2010-01-31 05:04:13.560  2010      1
7295 2010-01-31 05:05:13.600  2010      1
7296 2010-01-31 05:06:13.650  2010      1
7297 2010-01-31 05:07:13.710  2010      1
7298 2010-01-31 05:08:13.780  2010      1
7299 2010-01-31 05:09:13.860  2010      1

[7300 rows x 13 columns]
</pre>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="2.html" class="btn btn-neutral float-right" title="Projections: adding/selecting columns">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="0.html" class="btn btn-neutral" title="Intro and Setup"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Cloudera, Inc..
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.3.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  
 
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-65303298-2', 'auto');
  ga('send', 'pageview');

</script>


</body>
</html>